<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.proxy.ustclug.org/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="java,xpath," />





  <link rel="alternate" href="/atom.xml" title="Bianle's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="å¦‚æœè¦å‘Šè¯‰åˆ«äººä¹°ä¸€åŠ ä»‘ç‰›å¥¶ï¼Œæ‚¨ä¼šæ€ä¹ˆè¯´ï¼Ÿâ€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ è¿˜æ˜¯ â€œä»å‰é—¨å‡ºå»ï¼Œå‘å·¦è½¬ï¼Œèµ°ä¸‰ä¸ªè¡—åŒºå‘å³è½¬ï¼Œå†èµ°åŠä¸ªè¡—åŒºå‘å³è½¬è¿›å…¥å•†åº—ã€‚èµ°å‘å››å·é€šé“ï¼Œæ²¿é€šé“èµ°äº”ç±³å‘å·¦ï¼Œæ‹¿ä¸€ç“¶ä¸€åŠ ä»‘è£…çš„ç‰›å¥¶ç„¶ååˆ°æ”¶é“¶å°ä»˜æ¬¾ã€‚å†æ²¿åŸè·¯å›å®¶ã€‚â€ ç®€ç›´å¤ªå¯ç¬‘äº†ã€‚åªè¦åœ¨ â€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ çš„åŸºç¡€ä¸Šç¨åŠ æŒ‡ç¤ºï¼Œå¤šæ•°æˆäººéƒ½èƒ½è‡ªå·±ä¹°å›ç‰›å¥¶æ¥ã€‚
æŸ¥è¯¢è¯­è¨€å’Œè®¡ç®—æœºæœç´¢ä¸æ­¤ç±»ä¼¼ã€‚ç›´æ¥è¯´ â€œæ‰¾ä¸€ä¸ª Cryptonomico">
<meta property="og:type" content="article">
<meta property="og:title" content="Java è¯­è¨€çš„ XPath API">
<meta property="og:url" content="http://2le.me/2012/06/05/java-xpath-api/index.html">
<meta property="og:site_name" content="Bianle's Blog">
<meta property="og:description" content="å¦‚æœè¦å‘Šè¯‰åˆ«äººä¹°ä¸€åŠ ä»‘ç‰›å¥¶ï¼Œæ‚¨ä¼šæ€ä¹ˆè¯´ï¼Ÿâ€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ è¿˜æ˜¯ â€œä»å‰é—¨å‡ºå»ï¼Œå‘å·¦è½¬ï¼Œèµ°ä¸‰ä¸ªè¡—åŒºå‘å³è½¬ï¼Œå†èµ°åŠä¸ªè¡—åŒºå‘å³è½¬è¿›å…¥å•†åº—ã€‚èµ°å‘å››å·é€šé“ï¼Œæ²¿é€šé“èµ°äº”ç±³å‘å·¦ï¼Œæ‹¿ä¸€ç“¶ä¸€åŠ ä»‘è£…çš„ç‰›å¥¶ç„¶ååˆ°æ”¶é“¶å°ä»˜æ¬¾ã€‚å†æ²¿åŸè·¯å›å®¶ã€‚â€ ç®€ç›´å¤ªå¯ç¬‘äº†ã€‚åªè¦åœ¨ â€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ çš„åŸºç¡€ä¸Šç¨åŠ æŒ‡ç¤ºï¼Œå¤šæ•°æˆäººéƒ½èƒ½è‡ªå·±ä¹°å›ç‰›å¥¶æ¥ã€‚
æŸ¥è¯¢è¯­è¨€å’Œè®¡ç®—æœºæœç´¢ä¸æ­¤ç±»ä¼¼ã€‚ç›´æ¥è¯´ â€œæ‰¾ä¸€ä¸ª Cryptonomico">
<meta property="og:updated_time" content="2016-10-13T03:10:24.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java è¯­è¨€çš„ XPath API">
<meta name="twitter:description" content="å¦‚æœè¦å‘Šè¯‰åˆ«äººä¹°ä¸€åŠ ä»‘ç‰›å¥¶ï¼Œæ‚¨ä¼šæ€ä¹ˆè¯´ï¼Ÿâ€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ è¿˜æ˜¯ â€œä»å‰é—¨å‡ºå»ï¼Œå‘å·¦è½¬ï¼Œèµ°ä¸‰ä¸ªè¡—åŒºå‘å³è½¬ï¼Œå†èµ°åŠä¸ªè¡—åŒºå‘å³è½¬è¿›å…¥å•†åº—ã€‚èµ°å‘å››å·é€šé“ï¼Œæ²¿é€šé“èµ°äº”ç±³å‘å·¦ï¼Œæ‹¿ä¸€ç“¶ä¸€åŠ ä»‘è£…çš„ç‰›å¥¶ç„¶ååˆ°æ”¶é“¶å°ä»˜æ¬¾ã€‚å†æ²¿åŸè·¯å›å®¶ã€‚â€ ç®€ç›´å¤ªå¯ç¬‘äº†ã€‚åªè¦åœ¨ â€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ çš„åŸºç¡€ä¸Šç¨åŠ æŒ‡ç¤ºï¼Œå¤šæ•°æˆäººéƒ½èƒ½è‡ªå·±ä¹°å›ç‰›å¥¶æ¥ã€‚
æŸ¥è¯¢è¯­è¨€å’Œè®¡ç®—æœºæœç´¢ä¸æ­¤ç±»ä¼¼ã€‚ç›´æ¥è¯´ â€œæ‰¾ä¸€ä¸ª Cryptonomico">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://2le.me/2012/06/05/java-xpath-api/"/>





  <title>Java è¯­è¨€çš„ XPath API | Bianle's Blog</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <!-- hexo-inject:begin --><!-- hexo-inject:end --><script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3519f77bf8b5b1d5a98cc671b3a83214";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Bianle's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">The quieter you become, the more you are able to hear.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…¬ç›Š404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2012/06/05/java-xpath-api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java è¯­è¨€çš„ XPath API</h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/06/05/java-xpath-api/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/06/05/java-xpath-api/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o">æœ¬æ–‡æ€»é˜…è¯»é‡</i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>æ¬¡
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>å¦‚æœè¦å‘Šè¯‰åˆ«äººä¹°ä¸€åŠ ä»‘ç‰›å¥¶ï¼Œæ‚¨ä¼šæ€ä¹ˆè¯´ï¼Ÿâ€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ è¿˜æ˜¯ â€œä»å‰é—¨å‡ºå»ï¼Œå‘å·¦è½¬ï¼Œèµ°ä¸‰ä¸ªè¡—åŒºå‘å³è½¬ï¼Œå†èµ°åŠä¸ªè¡—åŒºå‘å³è½¬è¿›å…¥å•†åº—ã€‚èµ°å‘å››å·é€šé“ï¼Œæ²¿é€šé“èµ°äº”ç±³å‘å·¦ï¼Œæ‹¿ä¸€ç“¶ä¸€åŠ ä»‘è£…çš„ç‰›å¥¶ç„¶ååˆ°æ”¶é“¶å°ä»˜æ¬¾ã€‚å†æ²¿åŸè·¯å›å®¶ã€‚â€ ç®€ç›´å¤ªå¯ç¬‘äº†ã€‚åªè¦åœ¨ â€œè¯·å»ä¹°ä¸€åŠ ä»‘ç‰›å¥¶å›æ¥â€ çš„åŸºç¡€ä¸Šç¨åŠ æŒ‡ç¤ºï¼Œå¤šæ•°æˆäººéƒ½èƒ½è‡ªå·±ä¹°å›ç‰›å¥¶æ¥ã€‚
æŸ¥è¯¢è¯­è¨€å’Œè®¡ç®—æœºæœç´¢ä¸æ­¤ç±»ä¼¼ã€‚ç›´æ¥è¯´ â€œæ‰¾ä¸€ä¸ª Cryptonomicon çš„å‰¯æœ¬â€ è¦æ¯”ç¼–å†™æœç´¢æŸä¸ªæ•°æ®åº“çš„è¯¦ç»†é€»è¾‘å®¹æ˜“å¾—å¤šã€‚ç”±äºæœç´¢æ“ä½œçš„é€»è¾‘éå¸¸ç›¸ä¼¼ï¼Œå¯ä»¥å‘æ˜ä¸€ç§é€šç”¨è¯­è¨€è®©æ‚¨ä½¿ç”¨ â€œæ‰¾åˆ° Neal Stephenson çš„æ‰€æœ‰è‘—ä½œâ€ è¿™æ ·çš„å‘½ä»¤ï¼Œç„¶åç¼–å†™å¯¹ç‰¹å®šæ•°æ®å­˜å‚¨æ‰§è¡Œæ­¤ç±»æŸ¥è¯¢çš„å¼•æ“ã€‚</p>
<h1 id="xpath"><a class="header-anchor" href="#xpath"> </a>XPath</h1>
<p>åœ¨ä¼—å¤šæŸ¥è¯¢è¯­è¨€ä¹‹ä¸­ï¼Œç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆSQLï¼‰æ˜¯ä¸€ç§é’ˆå¯¹æŸ¥è¯¢ç‰¹å®šç±»å‹çš„å…³ç³»åº“è€Œè®¾è®¡å’Œä¼˜åŒ–çš„è¯­è¨€ã€‚å…¶ä»–ä¸é‚£ä¹ˆå¸¸è§çš„æŸ¥è¯¢è¯­è¨€è¿˜æœ‰å¯¹è±¡æŸ¥è¯¢è¯­è¨€ï¼ˆOQLï¼‰å’Œ XQueryã€‚ä½†æœ¬æ–‡çš„ä¸»é¢˜æ˜¯ XPathï¼Œä¸€ç§ä¸ºæŸ¥è¯¢ XML æ–‡æ¡£è€Œè®¾è®¡çš„æŸ¥è¯¢è¯­è¨€ã€‚æ¯”å¦‚ï¼Œä¸‹é¢è¿™ä¸ªç®€å•çš„ XPath æŸ¥è¯¢å¯ä»¥åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°ä½œè€…ä¸º Neal Stephenson çš„æ‰€æœ‰å›¾ä¹¦çš„æ ‡é¢˜ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><div class="line"><span class="regexp">//</span>book[author=<span class="string">"Neal Stephenson"</span>]<span class="regexp">/title</span></div></pre></td></tr></table></figure>
<p>ä½œä¸ºå¯¹ç…§ï¼ŒæŸ¥è¯¢åŒæ ·ä¿¡æ¯çš„çº¯ DOM æœç´¢ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><div class="line">ArrayList result = <span class="keyword">new</span> ArrayList();</div><div class="line">NodeList books = doc.getElementsByTagName(<span class="string">"book"</span>);</div><div class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; books.getLength(); i++) &#123;</div><div class="line">    <span class="built_in">Element</span> book = (<span class="built_in">Element</span>) books.item(i);</div><div class="line">    NodeList authors = book.getElementsByTagName(<span class="string">"author"</span>);</div><div class="line">    boolean stephenson = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; authors.getLength(); j++) &#123;</div><div class="line">        <span class="built_in">Element</span> author = (<span class="built_in">Element</span>) authors.item(j);</div><div class="line">        NodeList children = author.getChildNodes();</div><div class="line">        <span class="built_in">StringBuffer</span> sb = <span class="keyword">new</span> <span class="built_in">StringBuffer</span>();</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; children.getLength(); k++) &#123;</div><div class="line">            Node child = children.item(k);</div><div class="line">            <span class="comment">// really should to do this recursively</span></div><div class="line">            <span class="keyword">if</span> (child.getNodeType() == Node.TEXT_NODE) &#123;</div><div class="line">                sb.append(child.getNodeValue());</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (sb.toString().equals(<span class="string">"Neal Stephenson"</span>)) &#123;</div><div class="line">            stephenson = <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (stephenson) &#123;</div><div class="line">        NodeList titles = book.getElementsByTagName(<span class="string">"title"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; titles.getLength(); j++) &#123;</div><div class="line">            result.add(titles.item(j));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸è®ºæ‚¨æ˜¯å¦ç›¸ä¿¡ï¼Œä»¥ä¸Šä»£ç ä¸­çš„ DOM æ˜¾ç„¶ä¸å¦‚ç®€å•çš„ XPath è¡¨è¾¾å¼é€šç”¨æˆ–è€…å¥å£®ã€‚æ‚¨æ„¿æ„ç¼–å†™ã€è°ƒè¯•å’Œç»´æŠ¤å“ªä¸€ä¸ªï¼Ÿæˆ‘æƒ³ç­”æ¡ˆå¾ˆæ˜æ˜¾ã€‚
ä½†æ˜¯è™½ç„¶æœ‰å¾ˆå¼ºçš„è¡¨è¾¾èƒ½åŠ›ï¼ŒXPath å¹¶ä¸æ˜¯ Java è¯­è¨€ï¼Œäº‹å®ä¸Š XPath ä¸æ˜¯ä¸€ç§å®Œæ•´çš„ç¼–ç¨‹è¯­è¨€ã€‚æœ‰å¾ˆå¤šä¸œè¥¿ç”¨ XPath è¡¨è¾¾ä¸å‡ºæ¥ï¼Œç”šè‡³æœ‰äº›æŸ¥è¯¢ä¹Ÿæ— æ³•è¡¨è¾¾ã€‚æ¯”æ–¹è¯´ï¼ŒXPath ä¸èƒ½æŸ¥æ‰¾å›½é™…æ ‡å‡†å›¾ä¹¦ç¼–ç ï¼ˆISBNï¼‰æ£€éªŒç ä¸åŒ¹é…çš„æ‰€æœ‰å›¾ä¹¦ï¼Œæˆ–è€…æ‰¾å‡ºå¢ƒå¤–å¸æˆ·æ•°æ®åº“æ˜¾ç¤ºæ¬ å¸çš„æ‰€æœ‰ä½œè€…ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¯ä»¥æŠŠ XPath ç»“åˆåˆ° Java ç¨‹åºä¸­ï¼Œè¿™æ ·å°±èƒ½å‘æŒ¥ä¸¤è€…çš„ä¼˜åŠ¿äº†ï¼šJava åš Java æ‰€æ“…é•¿çš„ï¼ŒXPath åš XPath æ‰€æ“…é•¿çš„ã€‚
ç›´åˆ°æœ€è¿‘ï¼ŒJava ç¨‹åºæ‰§è¡Œ XPath æŸ¥è¯¢æ‰€éœ€è¦çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰è¿˜å› å½¢å½¢è‰²è‰²çš„ XPath å¼•æ“è€Œå„ä¸ç›¸åŒã€‚Xalan æœ‰ä¸€ç§ APIï¼ŒSaxon ä½¿ç”¨å¦ä¸€ç§ï¼Œå…¶ä»–å¼•æ“åˆ™ä½¿ç”¨å…¶ä»–çš„ APIã€‚è¿™æ„å‘³ç€ä»£ç å¾€å¾€æŠŠæ‚¨é™åˆ¶åˆ°ä¸€ç§äº§å“ä¸Šã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæœ€å¥½èƒ½å¤Ÿè¯•éªŒå…·æœ‰ä¸åŒæ€§èƒ½ç‰¹ç‚¹çš„å„ç§å¼•æ“ï¼Œè€Œä¸ä¼šå¸¦æ¥ä¸é€‚å½“çš„éº»çƒ¦æˆ–è€…é‡æ–°ç¼–å†™ä»£ç ã€‚
äºæ˜¯ï¼ŒJava 5 æ¨å‡ºäº† javax.xml.xpath åŒ…ï¼Œæä¾›ä¸€ä¸ªå¼•æ“å’Œå¯¹è±¡æ¨¡å‹ç‹¬ç«‹çš„ XPath åº“ã€‚è¿™ä¸ªåŒ…ä¹Ÿå¯ç”¨äº Java 1.3 åŠä»¥åçš„ç‰ˆæœ¬ï¼Œä½†éœ€è¦å•ç‹¬å®‰è£… Java API for XML Processing (JAXP) 1.3ã€‚Xalan 2.7 å’Œ Saxon 8 ä»¥åŠå…¶ä»–äº§å“åŒ…å«äº†è¿™ä¸ªåº“çš„å®ç°ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­
æˆ‘å°†ä¸¾ä¾‹è¯´æ˜å¦‚ä½•ä½¿ç”¨å®ƒã€‚ç„¶åå†è®¨è®ºä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚å‡è®¾è¦æŸ¥è¯¢ä¸€ä¸ªå›¾ä¹¦åˆ—è¡¨ï¼Œå¯»æ‰¾ Neal Stephenson çš„è‘—ä½œã€‚å…·ä½“æ¥è¯´ï¼Œè¿™ä¸ªå›¾ä¹¦åˆ—è¡¨çš„å½¢å¼å¦‚ æ¸…å• 2 æ‰€ç¤ºï¼š
æ¸…å• 2. åŒ…å«å›¾ä¹¦ä¿¡æ¯çš„ XML æ–‡æ¡£</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">inventory</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">year</span>=<span class="string">"2000"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Snow Crash<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>Neal Stephenson<span class="tag">&lt;/<span class="name">author</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">publisher</span>&gt;</span>Spectra<span class="tag">&lt;/<span class="name">publisher</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">isbn</span>&gt;</span>0553380958<span class="tag">&lt;/<span class="name">isbn</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>14.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">book</span>&gt;</span></div><div class="line"> </div><div class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">year</span>=<span class="string">"2005"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Burning Tower<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>Larry Niven<span class="tag">&lt;/<span class="name">author</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>Jerry Pournelle<span class="tag">&lt;/<span class="name">author</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">publisher</span>&gt;</span>Pocket<span class="tag">&lt;/<span class="name">publisher</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">isbn</span>&gt;</span>0743416910<span class="tag">&lt;/<span class="name">isbn</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>5.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">book</span>&gt;</span></div><div class="line"> </div><div class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">year</span>=<span class="string">"1995"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Zodiac<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>Neal Stephenson<span class="tag">&lt;<span class="name">author</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">publisher</span>&gt;</span>Spectra<span class="tag">&lt;/<span class="name">publisher</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">isbn</span>&gt;</span>0553573862<span class="tag">&lt;/<span class="name">isbn</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>7.50<span class="tag">&lt;/<span class="name">price</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">book</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- more books... --&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;/<span class="name">inventory</span>&gt;</span></div></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾æ‰€æœ‰å›¾ä¹¦çš„ XPath æŸ¥è¯¢éå¸¸ç®€å•ï¼š//book[author=â€œNeal Stephensonâ€]ã€‚ä¸ºäº†æ‰¾å‡ºè¿™äº›å›¾ä¹¦çš„æ ‡é¢˜ï¼Œåªè¦å¢åŠ ä¸€æ­¥ï¼Œè¡¨è¾¾å¼å°±å˜æˆäº† //book[author=â€œNeal Stephensonâ€]/titleã€‚æœ€åï¼ŒçœŸæ­£éœ€è¦çš„æ˜¯ title å…ƒç´ çš„æ–‡æœ¬èŠ‚ç‚¹å­©å­ã€‚è¿™å°±è¦æ±‚å†å¢åŠ ä¸€æ­¥ï¼Œå®Œæ•´çš„è¡¨è¾¾å¼å°±æ˜¯ //book[author=â€œNeal Stephensonâ€]/title/text()ã€‚
ç°åœ¨æˆ‘æä¾›ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œå®ƒä» Java è¯­è¨€ä¸­æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œç„¶åæŠŠæ‰¾åˆ°çš„æ‰€æœ‰å›¾ä¹¦çš„æ ‡é¢˜æ‰“å°å‡ºæ¥ã€‚é¦–å…ˆï¼Œéœ€è¦å°†æ–‡æ¡£åŠ è½½åˆ°ä¸€ä¸ª DOM Document å¯¹è±¡ä¸­ã€‚ä¸ºäº†ç®€åŒ–èµ·è§ï¼Œå‡è®¾è¯¥æ–‡æ¡£åœ¨å½“å‰å·¥ä½œç›®å½•çš„ books.xml æ–‡ä»¶ä¸­ã€‚ä¸‹é¢çš„ç®€å•ä»£ç ç‰‡æ®µè§£ææ–‡æ¡£å¹¶å»ºç«‹å¯¹åº”çš„ Document å¯¹è±¡ï¼š
æ¸…å• 3. ç”¨ JAXP è§£ææ–‡æ¡£</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><div class="line">DocumentBuilderFactory <span class="keyword">factory</span> = DocumentBuilderFactory.newInstance();</div><div class="line">        <span class="keyword">factory</span>.setNamespaceAware(<span class="keyword">true</span>); <span class="comment">// never forget this!</span></div><div class="line">        DocumentBuilder builder = <span class="keyword">factory</span>.newDocumentBuilder();</div><div class="line">        Document doc = builder.parse(<span class="string">"books.xml"</span>);</div></pre></td></tr></table></figure>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä»…ä»…æ˜¯æ ‡å‡†çš„ JAXP å’Œ DOMï¼Œæ²¡æœ‰ä»€ä¹ˆæ–°é²œçš„ã€‚
æ¥ä¸‹æ¥åˆ›å»º XPathFactoryï¼š
XPathFactory factory = XPathFactory.newInstance();
ç„¶åä½¿ç”¨è¿™ä¸ªå·¥å‚åˆ›å»º XPath å¯¹è±¡ï¼š
XPath xpath = factory.newXPath();
XPath å¯¹è±¡ç¼–è¯‘ XPath è¡¨è¾¾å¼ï¼š
PathExpression expr = xpath.compile(&quot;//book[author=â€˜Neal Stephensonâ€™]/title/text()&quot;);
ç›´æ¥æ±‚å€¼
å¦‚æœ XPath è¡¨è¾¾å¼åªä½¿ç”¨ä¸€æ¬¡ï¼Œå¯ä»¥è·³è¿‡ç¼–è¯‘æ­¥éª¤ç›´æ¥å¯¹ XPath å¯¹è±¡è°ƒç”¨ evaluate() æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æœåŒä¸€ä¸ªè¡¨è¾¾å¼è¦é‡å¤ä½¿ç”¨å¤šæ¬¡ï¼Œç¼–è¯‘å¯èƒ½æ›´å¿«ä¸€äº›ã€‚
æœ€åï¼Œè®¡ç®— XPath è¡¨è¾¾å¼å¾—åˆ°ç»“æœã€‚è¡¨è¾¾å¼æ˜¯é’ˆå¯¹ç‰¹å®šçš„ä¸Šä¸‹æ–‡èŠ‚ç‚¹è®¡ç®—çš„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯æ•´ä¸ªæ–‡æ¡£ã€‚è¿˜å¿…é¡»æŒ‡å®šè¿”å›ç±»å‹ã€‚è¿™é‡Œè¦æ±‚è¿”å›ä¸€ä¸ªèŠ‚ç‚¹é›†ï¼š
Object result = expr.evaluate(doc, XPathConstants.NODESET);
å¯ä»¥å°†ç»“æœå¼ºåˆ¶è½¬åŒ–æˆ DOM NodeListï¼Œç„¶åéå†åˆ—è¡¨å¾—åˆ°æ‰€æœ‰çš„æ ‡é¢˜ï¼š
NodeList nodes = (NodeList) result;
for (int i = 0; i &lt; nodes.getLength(); i++) {
System.out.println(nodes.item(i).getNodeValue());
}
æ¸…å• 4 æŠŠä¸Šè¿°ç‰‡æ®µç»„åˆåˆ°äº†ä¸€ä¸ªç¨‹åºä¸­ã€‚è¿˜è¦æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•å¯èƒ½æŠ›å‡ºä¸€äº›æ£€æŸ¥å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å¿…é¡»åœ¨ throws å­å¥ä¸­å£°æ˜ï¼Œä½†æ˜¯æˆ‘åœ¨ä¸Šé¢æŠŠå®ƒä»¬æ©ç›–èµ·æ¥äº†ï¼š
æ¸…å• 4. ç”¨å›ºå®šçš„ XPath è¡¨è¾¾å¼æŸ¥è¯¢ XML æ–‡æ¡£çš„å®Œæ•´ç¨‹åº
import java.io.IOException;
import org.w3c.dom.<em>;
import org.xml.sax.SAXException;
import javax.xml.parsers.</em>;
import javax.xml.xpath.*;</p>
<p>public class XPathExample {</p>
<p>public static void main(String[] args)
throws ParserConfigurationException, SAXException,
IOException, XPathExpressionException {</p>
<pre><code>DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
domFactory.setNamespaceAware(true); // never forget this!
DocumentBuilder builder = domFactory.newDocumentBuilder();
Document doc = builder.parse(&quot;books.xml&quot;);

XPathFactory factory = XPathFactory.newInstance();
XPath xpath = factory.newXPath();
XPathExpression expr 
 = xpath.compile(&quot;//book[author='Neal Stephenson']/title/text()&quot;);

Object result = expr.evaluate(doc, XPathConstants.NODESET);
NodeList nodes = (NodeList) result;
for (int i = 0; i &lt; nodes.getLength(); i++) {
    System.out.println(nodes.item(i).getNodeValue()); 
}
</code></pre>
<p>}</p>
<p>}
XPath æ•°æ®æ¨¡å‹
æ¯å½“æ··åˆä½¿ç”¨è¯¸å¦‚ XPath å’Œ Java è¿™æ ·ä¸¤ç§ä¸åŒçš„è¯­è¨€æ—¶ï¼Œå¿…å®šä¼šæœ‰æŸäº›å°†ä¸¤è€…ç²˜åˆåœ¨ä¸€èµ·çš„æ˜æ˜¾æ¥ç¼ã€‚å¹¶éä¸€åˆ‡éƒ½å¾ˆåˆæ‹ã€‚XPath å’Œ Java è¯­è¨€æ²¡æœ‰åŒæ ·çš„ç±»å‹ç³»ç»Ÿã€‚XPath 1.0 åªæœ‰å››ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼š
node-set
number
boolean
string
å½“ç„¶ï¼ŒJava è¯­è¨€æœ‰æ›´å¤šçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹ã€‚
å¤šæ•° XPath è¡¨è¾¾å¼ï¼Œç‰¹åˆ«æ˜¯ä½ç½®è·¯å¾„ï¼Œéƒ½è¿”å›èŠ‚ç‚¹é›†ã€‚ä½†æ˜¯è¿˜æœ‰å…¶ä»–å¯èƒ½ã€‚æ¯”å¦‚ï¼ŒXPath è¡¨è¾¾å¼ count(//book) è¿”å›æ–‡æ¡£ä¸­çš„å›¾ä¹¦æ•°é‡ã€‚XPath è¡¨è¾¾å¼ count(//book[@author=â€œNeal Stephensonâ€]) &gt; 10 è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼šå¦‚æœæ–‡æ¡£ä¸­ Neal Stephenson çš„è‘—ä½œè¶…è¿‡ 10 æœ¬åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
evaluate() æ–¹æ³•è¢«å£°æ˜ä¸ºè¿”å› Objectã€‚å®é™…è¿”å›ä»€ä¹ˆä¾èµ–äº XPath è¡¨è¾¾å¼çš„ç»“æœä»¥åŠè¦æ±‚çš„ç±»å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒXPath çš„
number æ˜ å°„ä¸º java.lang.Double
string æ˜ å°„ä¸º java.lang.String
boolean æ˜ å°„ä¸º java.lang.Boolean
node-set æ˜ å°„ä¸º org.w3c.dom.NodeList
XPath 2
å‰é¢ä¸€ç›´å‡è®¾æ‚¨ä½¿ç”¨çš„æ˜¯ XPath 1.0ã€‚XPath 2 å¤§å¤§æ‰©å±•å’Œä¿®æ”¹äº†ç±»å‹ç³»ç»Ÿã€‚Java XPath API æ”¯æŒ XPath 2 æ‰€éœ€çš„ä¸»è¦ä¿®æ”¹æ˜¯ä¸ºè¿”å› XPath 2 æ–°æ•°æ®ç±»å‹å¢åŠ å¸¸é‡ã€‚
åœ¨ Java ä¸­è®¡ç®— XPath è¡¨è¾¾å¼æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šéœ€è¦çš„è¿”å›ç±»å‹ã€‚æœ‰äº”ç§å¯èƒ½ï¼Œéƒ½åœ¨ javax.xml.xpath.XPathConstants ç±»ä¸­å‘½åäº†å¸¸é‡ï¼š
XPathConstants.NODESET
XPathConstants.BOOLEAN
XPathConstants.NUMBER
XPathConstants.STRING
XPathConstants.NODE
æœ€åä¸€ä¸ª XPathConstants.NODE å®é™…ä¸Šæ²¡æœ‰åŒ¹é…çš„ XPath ç±»å‹ã€‚åªæœ‰çŸ¥é“ XPath è¡¨è¾¾å¼åªè¿”å›ä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…åªéœ€è¦ä¸€ä¸ªèŠ‚ç‚¹æ—¶æ‰ä½¿ç”¨å®ƒã€‚å¦‚æœ XPath è¡¨è¾¾å¼è¿”å›äº†å¤šä¸ªèŠ‚ç‚¹å¹¶ä¸”æŒ‡å®šäº† XPathConstants.NODEï¼Œåˆ™ evaluate() æŒ‰ç…§æ–‡æ¡£é¡ºåºè¿”å›ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœ XPath è¡¨è¾¾å¼é€‰æ‹©äº†ä¸€ä¸ªç©ºé›†å¹¶æŒ‡å®šäº† XPathConstants.NODEï¼Œåˆ™ evaluate() è¿”å› nullã€‚
å¦‚æœä¸èƒ½å®Œæˆè¦æ±‚çš„è½¬æ¢ï¼Œevaluate() å°†æŠ›å‡º XPathExceptionã€‚
å›é¡µé¦–
åç§°ç©ºé—´ä¸Šä¸‹æ–‡
è‹¥ XML æ–‡æ¡£ä¸­çš„å…ƒç´ åœ¨åç§°ç©ºé—´ä¸­ï¼ŒæŸ¥è¯¢è¯¥æ–‡æ¡£çš„ XPath è¡¨è¾¾å¼å¿…é¡»ä½¿ç”¨ç›¸åŒçš„åç§°ç©ºé—´ã€‚XPath è¡¨è¾¾å¼ä¸ä¸€å®šè¦ä½¿ç”¨ç›¸åŒçš„å‰ç¼€ï¼Œåªéœ€è¦åç§°ç©ºé—´ URI ç›¸åŒå³å¯ã€‚äº‹å®ä¸Šï¼Œå¦‚æœ XML æ–‡æ¡£ä½¿ç”¨é»˜è®¤åç§°ç©ºé—´ï¼Œé‚£ä¹ˆå°½ç®¡ç›®æ ‡æ–‡æ¡£æ²¡æœ‰ä½¿ç”¨å‰ç¼€ï¼ŒXPath è¡¨è¾¾å¼ä¹Ÿå¿…é¡»ä½¿ç”¨å‰ç¼€ã€‚
ä½†æ˜¯ï¼ŒJava ç¨‹åºä¸æ˜¯ XML æ–‡æ¡£ï¼Œå› æ­¤ä¸èƒ½ç”¨ä¸€èˆ¬çš„åç§°ç©ºé—´è§£æã€‚å¿…é¡»æä¾›ä¸€ä¸ªå¯¹è±¡å°†å‰ç¼€æ˜ å°„åˆ°åç§°ç©ºé—´ URIã€‚è¯¥å¯¹è±¡æ˜¯ javax.xml.namespace.NamespaceContext æ¥å£çš„å®ä¾‹ã€‚æ¯”å¦‚ï¼Œå‡è®¾å›¾ä¹¦æ–‡æ¡£æ”¾åœ¨ <a href="http://www.example.com/books" target="_blank" rel="external">http://www.example.com/books</a> åç§°ç©ºé—´ä¸­ï¼Œå¦‚ æ¸…å• 5 æ‰€ç¤ºï¼š
æ¸…å• 5. ä½¿ç”¨é»˜è®¤åç§°ç©ºé—´çš„ XML æ–‡æ¡£
<inventory xmlns="http://www.example.com/books">
<book year="2000">
<title>Snow Crash</title>
<author>Neal Stephenson</author>
<publisher>Spectra</publisher>
<isbn>0553380958</isbn>
<price>14.95<price>
</price></price></book></inventory></p>
<pre><code>&lt;!-- more books... --&gt;
</code></pre>
<inventory>
æŸ¥æ‰¾ Neal Stephenson å…¨éƒ¨è‘—ä½œæ ‡é¢˜çš„ XPath è¡¨è¾¾å¼å°±è¦æ”¹ä¸º //pre:book[pre:author="Neal Stephenson"]/pre:title/text()ã€‚ä½†æ˜¯ï¼Œå¿…é¡»å°†å‰ç¼€ pre æ˜ å°„åˆ° URI http://www.example.com/booksã€‚NamespaceContext æ¥å£åœ¨ Java è½¯ä»¶å¼€å‘å·¥å…·ç®±ï¼ˆJDKï¼‰æˆ– JAXP ä¸­æ²¡æœ‰é»˜è®¤å®ç°ä¼¼ä¹æœ‰ç‚¹ç¬¨ï¼Œä½†ç¡®å®å¦‚æ­¤ã€‚ä¸è¿‡ï¼Œè‡ªå·±å®ç°ä¹Ÿä¸éš¾ã€‚æ¸…å• 6 å¯¹ä¸€ä¸ªåç§°ç©ºé—´ç»™å‡ºäº†ç®€å•çš„å®ç°ã€‚è¿˜éœ€è¦æ˜ å°„ xml å‰ç¼€ã€‚
æ¸…å• 6. ç»‘å®šä¸€ä¸ªåç§°ç©ºé—´å’Œé»˜è®¤åç§°ç©ºé—´çš„ç®€å•ä¸Šä¸‹æ–‡
import java.util.Iterator;
import javax.xml.*;
import javax.xml.namespace.NamespaceContext;
<p>public class PersonalNamespaceContext implements NamespaceContext {</p>
<pre><code>public String getNamespaceURI(String prefix) {
    if (prefix == null) throw new NullPointerException(&quot;Null prefix&quot;);
    else if (&quot;pre&quot;.equals(prefix)) return &quot;http://www.example.org/books&quot;;
    else if (&quot;xml&quot;.equals(prefix)) return XMLConstants.XML_NS_URI;
    return XMLConstants.NULL_NS_URI;
}

// This method isn't necessary for XPath processing.
public String getPrefix(String uri) {
    throw new UnsupportedOperationException();
}

// This method isn't necessary for XPath processing either.
public Iterator getPrefixes(String uri) {
    throw new UnsupportedOperationException();
}
</code></pre>
<p>}
ä½¿ç”¨æ˜ å°„å­˜å‚¨ç»‘å®šå’Œå¢åŠ  setter æ–¹æ³•å®ç°åç§°ç©ºé—´ä¸Šä¸‹æ–‡çš„é‡ç”¨ä¹Ÿä¸éš¾ã€‚
åˆ›å»º NamespaceContext å¯¹è±¡åï¼Œåœ¨ç¼–è¯‘è¡¨è¾¾å¼ä¹‹å‰å°†å…¶å®‰è£…åˆ° XPath å¯¹è±¡ä¸Šã€‚ä»¥åå°±å¯ä»¥åƒä»¥å‰ä¸€æ ·æ˜¯ç”¨è¿™äº›å‰ç¼€æŸ¥è¯¢äº†ã€‚æ¯”å¦‚ï¼š
æ¸…å• 7. ä½¿ç”¨åç§°ç©ºé—´çš„ XPath æŸ¥è¯¢
XPathFactory factory = XPathFactory.newInstance();
XPath xpath = factory.newXPath();
xpath.setNamespaceContext(new PersonalNamespaceContext());
XPathExpression expr
= xpath.compile(&quot;//pre:book[pre:author=â€˜Neal Stephensonâ€™]/pre:title/text()&quot;);</p>
<p>Object result = expr.evaluate(doc, XPathConstants.NODESET);
NodeList nodes = (NodeList) result;
for (int i = 0; i &lt; nodes.getLength(); i++) {
System.out.println(nodes.item(i).getNodeValue());
}
å›é¡µé¦–
å‡½æ•°æ±‚è§£å™¨
æœ‰æ—¶å€™ï¼Œåœ¨ Java è¯­è¨€ä¸­å®šä¹‰ç”¨äº XPath è¡¨è¾¾å¼çš„æ‰©å±•å‡½æ•°å¾ˆæœ‰ç”¨ã€‚è¿™äº›å‡½æ•°å¯ä»¥æ‰§è¡Œç”¨çº¯ XPath å¾ˆéš¾æˆ–è€…æ— æ³•æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¸è¿‡å¿…é¡»æ˜¯çœŸæ­£çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯éšæ„çš„æ–¹æ³•ã€‚å°±æ˜¯è¯´ä¸èƒ½æœ‰å‰¯ä½œç”¨ã€‚ï¼ˆXPath å‡½æ•°å¯ä»¥æŒ‰ç…§ä»»æ„çš„é¡ºåºæ±‚å€¼ä»»æ„å¤šæ¬¡ã€‚ï¼‰
é€šè¿‡ Java XPath API è®¿é—®çš„æ‰©å±•å‡½æ•°å¿…é¡»å®ç° javax.xml.xpath.XPathFunction æ¥å£ã€‚è¿™ä¸ªæ¥å£åªå£°æ˜äº†ä¸€ä¸ªæ–¹æ³• evaluateï¼š
public Object evaluate(List args) throws XPathFunctionException
è¯¥æ–¹æ³•å¿…é¡»è¿”å› Java è¯­è¨€èƒ½å¤Ÿè½¬æ¢åˆ° XPath çš„äº”ç§ç±»å‹ä¹‹ä¸€ï¼š
String
Double
Boolean
Nodelist
Node
æ¯”å¦‚ï¼Œæ¸…å• 8 æ˜¾ç¤ºäº†ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œå®ƒæ£€æŸ¥ ISBN çš„æ ¡éªŒå’Œå¹¶è¿”å› Booleanã€‚è¿™ä¸ªæ ¡éªŒå’Œçš„åŸºæœ¬è§„åˆ™æ˜¯å‰ä¹ä½æ•°çš„æ¯ä¸€ä½ä¹˜ä¸Šå®ƒçš„ä½ç½®ï¼ˆå³ç¬¬ä¸€ä½æ•°ä¹˜ä¸Š 1ï¼Œç¬¬äºŒä½æ•°ä¹˜ä¸Š 2ï¼Œä¾æ¬¡ç±»æ¨ï¼‰ã€‚å°†è¿™äº›æ•°åŠ èµ·æ¥ç„¶åå–é™¤ä»¥ 11 çš„ä½™æ•°ã€‚å¦‚æœä½™æ•°æ˜¯ 10ï¼Œé‚£ä¹ˆæœ€åä¸€ä½æ•°å°±æ˜¯ Xã€‚
æ¸…å• 8. æ£€æŸ¥ ISBN çš„ XPath æ‰©å±•å‡½æ•°
import java.util.List;
import javax.xml.xpath.<em>;
import org.w3c.dom.</em>;</p>
<p>public class ISBNValidator implements XPathFunction {</p>
<p>// This class could easily be implemented as a Singleton.</p>
<p>public Object evaluate(List args) throws XPathFunctionException {</p>
<pre><code>if (args.size() != 1) {
  throw new XPathFunctionException(&quot;Wrong number of arguments to valid-isbn()&quot;);
}

String isbn;
Object o = args.get(0);

// perform conversions
if (o instanceof String) isbn = (String) args.get(0);
else if (o instanceof Boolean) isbn = o.toString();
else if (o instanceof Double) isbn = o.toString();
else if (o instanceof NodeList) {
    NodeList list = (NodeList) o;
    Node node = list.item(0);
    // getTextContent is available in Java 5 and DOM 3.
    // In Java 1.4 and DOM 2, you'd need to recursively 
    // accumulate the content.
    isbn= node.getTextContent();
}
else {
    throw new XPathFunctionException(&quot;Could not convert argument type&quot;);
}

char[] data = isbn.toCharArray();
if (data.length != 10) return Boolean.FALSE;
int checksum = 0;
for (int i = 0; i &lt; 9; i++) {
    checksum += (i+1) * (data[i]-'0');
}
int checkdigit = checksum % 11;

if (checkdigit + '0' == data[9] || (data[9] == 'X' &amp;&amp; checkdigit == 10)) {
    return Boolean.TRUE;
}
return Boolean.FALSE;
</code></pre>
<p>}</p>
<p>}
ä¸‹ä¸€æ­¥è®©è¿™ä¸ªæ‰©å±•å‡½æ•°èƒ½å¤Ÿåœ¨ Java ç¨‹åºä¸­ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œéœ€è¦åœ¨ç¼–è¯‘è¡¨è¾¾å¼ä¹‹å‰å‘ XPath å¯¹è±¡å®‰è£… javax.xml.xpath.XPathFunctionResolverã€‚å‡½æ•°æ±‚è§£å™¨å°†å‡½æ•°çš„ XPath åç§°å’Œåç§°ç©ºé—´ URI æ˜ å°„åˆ°å®ç°è¯¥å‡½æ•°çš„ Java ç±»ã€‚æ¸…å• 9 æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°æ±‚è§£å™¨ï¼Œå°†æ‰©å±•å‡½æ•° valid-isbn å’Œåç§°ç©ºé—´ <a href="http://www.example.org/books" target="_blank" rel="external">http://www.example.org/books</a> æ˜ å°„åˆ° æ¸…å• 8 ä¸­çš„ç±»ã€‚æ¯”å¦‚ï¼ŒXPath è¡¨è¾¾å¼ //book[not(pre:valid-isbn(isbn))] å¯ä»¥æ‰¾åˆ° ISBN æ ¡éªŒå’Œä¸åŒ¹é…çš„æ‰€æœ‰å›¾ä¹¦ã€‚
æ¸…å• 9. è¯†åˆ« valid-isbn æ‰©å±•å‡½æ•°çš„ä¸Šä¸‹æ–‡
iimport javax.xml.namespace.QName;
import javax.xml.xpath.*;</p>
<p>public class ISBNFunctionContext implements XPathFunctionResolver {</p>
<p>private static final QName name
= new QName(â€œ<a href="http://www.example.org/books" target="_blank" rel="external">http://www.example.org/books</a>â€, â€œvalid-isbnâ€);</p>
<p>public XPathFunction resolveFunction(QName name, int arity) {
if (name.equals(<a href="http://ISBNFunctionContext.name" target="_blank" rel="external">ISBNFunctionContext.name</a>) &amp;&amp; arity == 1) {
return new ISBNValidator();
}
return null;
}</p>
<p>}
ç”±äºæ‰©å±•å‡½æ•°å¿…é¡»æœ‰åç§°ç©ºé—´ï¼Œæ‰€ä»¥è®¡ç®—åŒ…å«æ‰©å±•å‡½æ•°çš„è¡¨è¾¾å¼æ—¶å¿…é¡»ä½¿ç”¨ NamespaceResolverï¼Œå³ä¾¿æŸ¥è¯¢çš„æ–‡æ¡£æ²¡æœ‰ä½¿ç”¨ä»»ä½•åç§°ç©ºé—´ã€‚ç”±äº XPathFunctionResolverã€XPathFunction å’Œ NamespaceResolver éƒ½æ˜¯æ¥å£ï¼Œå¦‚æœæ–¹ä¾¿çš„è¯å¯ä»¥å°†å®ƒä»¬æ”¾åœ¨æ‰€æœ‰çš„ç±»ä¸­ã€‚
å›é¡µé¦–
ç»“æŸè¯­
ç”¨ SQL å’Œ XPath è¿™æ ·çš„å£°æ˜æ€§è¯­è¨€ç¼–å†™æŸ¥è¯¢ï¼Œè¦æ¯”ä½¿ç”¨ Java å’Œ C è¿™æ ·çš„å‘½ä»¤å¼è¯­è¨€å®¹æ˜“å¾—å¤šã€‚ä½†æ˜¯ï¼Œç”¨ Java å’Œ C è¿™æ ·çš„å›¾çµå®Œæ•´è¯­è¨€ç¼–å†™å¤æ‚çš„é€»è¾‘ï¼Œåˆæ¯” SQL å’Œ XPath è¿™æ ·çš„å£°æ˜æ€§è¯­è¨€å®¹æ˜“å¾—å¤šã€‚æ‰€å¹¸çš„æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨ Java Database Connectivity (JDBC) å’Œ javax.xml.xpath ä¹‹ç±»çš„ API å¯ä»¥å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚éšç€ä¸–ç•Œä¸Šè¶Šæ¥è¶Šå¤šçš„æ•°æ®è½¬å‘ XMLï¼Œjavax.xml.xpath å°†ä¸ java.sql ä¸€æ ·å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚</p>
</inventory>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>èµä½ ä¸ªé¸¡è…¿ï¼Œåƒé¥±äº†å¥½å¥½å¹²ï¼</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>èµ</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/static/weixin.png" alt="bianle WeChat Pay"/>
          <p>å¾®ä¿¡æ‰“èµ</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/static/alipay.png" alt="bianle Alipay"/>
          <p>æ”¯ä»˜å®æ‰“èµ</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/java/" rel="tag"># java</a>
          
            <a href="/tags/xpath/" rel="tag"># xpath</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2012/06/05/linux-wget-guide/" rel="next" title="wgetç”¨æ³•">
                <i class="fa fa-chevron-left"></i> wgetç”¨æ³•
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2012/06/20/web-js-callback/" rel="prev" title="jså›è°ƒå‡½æ•°">
                jså›è°ƒå‡½æ•° <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2012/06/05/java-xpath-api/"
           data-title="Java è¯­è¨€çš„ XPath API" data-url="http://2le.me/2012/06/05/java-xpath-api/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars.githubusercontent.com/bianle"
               alt="bianle" />
          <p class="site-author-name" itemprop="name">bianle</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">242</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">54</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">161</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bianle" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bianlelpqi" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/i9erle" target="_blank" title="å¾®åš">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  å¾®åš
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://ğŸ˜‡ğŸ˜ˆ.ws" title="http://ğŸ˜‡ğŸ˜ˆ.ws" target="_blank">http://ğŸ˜‡ğŸ˜ˆ.ws</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://dzm.la" title="çŸ­æ€ä¹ˆå•¦" target="_blank">çŸ­æ€ä¹ˆå•¦</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.tunnel.ink" title="ngrok" target="_blank">ngrok</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://xingyetang.com" title="å”å…´ä¸šçš„åšå®¢" target="_blank">å”å…´ä¸šçš„åšå®¢</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.panpan.lu" title="å¢ç›¼ç›¼çš„åšå®¢" target="_blank">å¢ç›¼ç›¼çš„åšå®¢</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yangjian.me" title="Alimon's Blog" target="_blank">Alimon's Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://hexo.io" title="Hexo" target="_blank">Hexo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://timyang.net" title="Tim's Blog" target="_blank">Tim's Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://lifegoo.pluskid.org/wiki/index.html" title="æ˜Ÿé»æ®¿" target="_blank">æ˜Ÿé»æ®¿</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://phl.iteye.com" title="çŒ«å¤´å“¥ï¼ˆæœ´æµ·æ—ï¼‰" target="_blank">çŒ«å¤´å“¥ï¼ˆæœ´æµ·æ—ï¼‰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zhaxiancheng" title="zxc" target="_blank">zxc</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#xpath"><span class="nav-number">1.</span> <span class="nav-text"> XPath</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2012 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bianle</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user">æœ¬ç«™è®¿å®¢æ•°</i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      äººæ¬¡
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye">æœ¬ç«™æ€»è®¿é—®é‡</i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"2le"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  
















  





  

  

  

  

  

</body>
</html>

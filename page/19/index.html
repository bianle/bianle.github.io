<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.proxy.ustclug.org/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Bianle's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Bianle's Blog">
<meta property="og:url" content="http://2le.me/page/19/index.html">
<meta property="og:site_name" content="Bianle's Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bianle's Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://2le.me/page/19/"/>





  <title>Bianle's Blog</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3519f77bf8b5b1d5a98cc671b3a83214";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Bianle's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">The quieter you become, the more you are able to hear.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/10/web-js-window-resize/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/10/web-js-window-resize/" itemprop="url">改变当前浏览器窗口大小</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">"JavaScript"</span>&gt;</span><span class="undefined"></span></div><div class="line">    self.resizeTo(200,300)</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/10/db-mysql-err150/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/10/db-mysql-err150/" itemprop="url">mysql errno:150</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>当你试图在mysql中创建一个外键的时候，这个出错会经常发生，这是非常令人沮丧的。像这种不能创建一个.frm 文件的报错好像暗示着操作系统的文件的权限错误或者其它原因，但实际上，这些都不是的，事实上，这个mysql报错已经被报告是一个mysql本身的bug并出现在mysql 开发者列表当中很多年了，然而这似乎又是一种误导。
在很多实例中，这种错误的发生都是因为mysql一直以来都不能很好的支持的关系的问题， 更不幸的是它也并没有指明到底是哪一个问题会导致上面那种错误，下面我把导致这个可怕 的150错误的常见原因列出来了，并且我以可能性的大小作了排序
已知的原因：</p>
<ol>
<li>两个字段的类型或者大小不严格匹配，例如，如果一个是INT(10), 那么外键也必须设置成INT(10), 而不是 INT(11) 也不能是 TINYINT. 你得使用 SHOW 命令来查看字段的大小，因为一些查询浏览器有时候把 int(10) 和int(11) 都显示为integer。另外，你还必须确定两个字段是否一个为 SIGNED,而另一个又是UNSIGNED, 这两字段必须严格地一致匹配，更多关于signed 和 unsigned 的信息，请参阅：<a href="http://www.verysimple.com/blog/?p=57" target="_blank" rel="external">http://www.verysimple.com/blog/?p=57</a></li>
<li>你试图引用的其中一个外键没有建立起索引，或者不是一个primary key , 如果其中一个不是primary key 的放，你必须为它创建一个索引。</li>
<li>外键的名字是一个已经存在的一个键值了，这个时候，你应该检查你的数据库以确保外健名字是唯一的，或者你在键名后面加上几个随机的字符以测试是否是这个原因。</li>
<li>其中一个或者两个表是MyISAM引擎的表，若想要使用外键约束，必须是InnoDB引擎，（实际上，如果两个表都是MyISAM 引擎的，这个错误根本不会发生，但也不会产生外键），你可以通过查询浏览器来设置表的引擎类型</li>
<li>你可能设置了ON DELETE SET NULL, 但是相关的键的字段又设置成了NOTS NULL 值。你可能通过修改cascade 的属性值或者把字段属性设置成 allow null 来搞定这个bug.</li>
<li>请确定你的Charset 和 Collate 选项在表级和字段级上的一致</li>
<li>你可能设置为外键设置了一个默认值，如 default=0</li>
<li>在这个关系里面，其中的一个字段是一个混合键值中的一个，它没有自己独立的索引，这时，你必须为它创建一个独立的索引。</li>
<li>ALTER 声明中有语法错误</li>
<li>要连接的两个表的编码格式不同</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/10/web-scrollxxx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/10/web-scrollxxx/" itemprop="url">scrollLeft,scrollTop等等详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>一张图</p>
<p>image
网页可见区域宽： document.body.clientWidth;
网页可见区域高： document.body.clientHeight;
网页可见区域宽： document.body.offsetWidth (包括边线的宽);
网页可见区域高： document.body.offsetHeight (包括边线的宽);
网页正文全文宽： document.body.scrollWidth;
网页正文全文高： document.body.scrollHeight;
网页被卷去的高： document.body.scrollTop;
网页被卷去的左： document.body.scrollLeft;
网页正文部分上： window.screenTop;
网页正文部分左： window.screenLeft;
屏幕分辨率的高： window.screen.height;
屏幕分辨率的宽： window.screen.width;
屏幕可用工作区高度： window.screen.availHeight;
屏幕可用工作区宽度：window.screen.availWidth;
1、offsetLeft
假设 obj 为某个 HTML 控件。
obj.offsetTop 指 obj 距离上方或上层控件的位置，整型，单位像素。
obj.offsetLeft 指 obj 距离左方或上层控件的位置，整型，单位像素。
obj.offsetWidth 指 obj 控件自身的宽度，整型，单位像素。
obj.offsetHeight 指 obj 控件自身的高度，整型，单位像素。
我们对前面提到的“上方或上层”与“左方或上层”控件作个说明。
例如：</p>
<div id="tool"> 
<input type="button" value="提交"> 
<input type="button" value="重置"> 
</div> 
“提交”按钮的 offsetTop 指“提交”按钮距“tool”层上边框的距离，因为距其上边最近的是 “tool” 层的上边框。 
“重置”按钮的 offsetTop 指“重置”按钮距“tool”层上边框的距离，因为距其上边最近的是 “tool” 层的上边框。 
“提交”按钮的 offsetLeft 指“提交”按钮距“tool”层左边框的距离，因为距其左边最近的是 “tool” 层的左边框。 
“重置”按钮的 offsetLeft 指“重置”按钮距“提交”按钮右边框的距离，因为距其左边最近的是“提交”按钮的右边框。 
以上属性在 FireFox 中也有效。 
另 外：我们这里所说的是指 HTML 控件的属性值，并不是 document.body，document.body 的值在不同浏览器中有不同解释（实际上大多数环境是由于对 document.body 解释不同造成的，并不是由于对 offset 解释不同造成的），点击这里查看不同点。 
标题：offsetTop 与 style.top 的区别 
预备知识：offsetTop、offsetLeft、offsetWidth、offsetHeight 
我们知道 offsetTop 可以获得 HTML 元素距离上方或外层元素的位置，style.top 也是可以的，二者的区别是： 
一、offsetTop 返回的是数字，而 style.top 返回的是字符串，除了数字外还带有单位：px。 
二、offsetTop 只读，而 style.top 可读写。 
三、如果没有给 HTML 元素指定过 top 样式，则 style.top 返回的是空字符串。 
offsetLeft 与 style.left、offsetWidth 与 style.width、offsetHeight 与 style.height 也是同样道理。 
标题：clientHeight、offsetHeight和scrollHeight 
我们这里说说四种浏览器对 document.body 的 clientHeight、offsetHeight 和 scrollHeight 的解释，这里说的是 document.body，如果是 HTML 控件，则又有不同，点击这里查看。 
这四种浏览器分别为IE（Internet Explorer）、NS（Netscape）、Opera、FF（FireFox）。 
2、clientHeight 
clientHeight 
大家对 clientHeight 都没有什么异议，都认为是内容可视区域的高度，也就是说页面浏览器中可以看到内容的这个区域的高度，一般是最后一个工具条以下到状态栏以上的这个区域，与页面内容无关。 
offsetHeight 
IE、Opera 认为 offsetHeight = clientHeight + 滚动条 + 边框。 
NS、FF 认为 offsetHeight 是网页内容实际高度，可以小于 clientHeight。 
scrollHeight 
IE、Opera 认为 scrollHeight 是网页内容实际高度，可以小于 clientHeight。 
NS、FF 认为 scrollHeight 是网页内容高度，不过最小值是 clientHeight。 
简单地说 
clientHeight 就是透过浏览器看内容的这个区域高度。 
NS、 FF 认为 offsetHeight 和 scrollHeight 都是网页内容高度，只不过当网页内容高度小于等于 clientHeight 时，scrollHeight 的值是 clientHeight，而 offsetHeight 可以小于 clientHeight。 
IE、Opera 认为 offsetHeight 是可视区域 clientHeight 滚动条加边框。scrollHeight 则是网页内容实际高度。 
同理 
clientWidth、offsetWidth 和 scrollWidth 的解释与上面相同，只是把高度换成宽度即可。 
但是 
FF 在不同的 DOCTYPE 中对 clientHeight 的解释不同， xhtml 1 trasitional 中则不是如上解释的。其它浏览器则不存在此问题。 
标题：scrollTop、scrollLeft、scrollWidth、scrollHeight 
3、scrollLeft 
scrollTop 是“卷”起来的高度值，示例：
<div style="width:100px;height:100px;background-color:#FF0000;overflow:hidden;" id="p">
  <div style="width:50px;height:300px;background-color:#0000FF;" id="t">如果为 p 设置了 scrollTop，这些内容可能不会完全显示。</div>
  </div>
  <script type="text/javascript">

  var p = document.getElementById("p");

  p.scrollTop = 10;

  </script>
<p>由于为外层元素 p 设置了 scrollTop，所以内层元素会向上卷。
scrollLeft 也是类似道理。
我们已经知道 offsetHeight 是自身元素的宽度。
而 scrollHeight 是内部元素的绝对宽度，包含内部元素的隐藏的部分。
上述中 p 的 scrollHeight 为 300，而 p 的 offsetHeight 为 100。
scrollWidth 也是类似道理。
IE 和 FireFox 全面支持，而 Netscape 和 Opera 不支持 scrollTop、scrollLeft（document.body 除外）。
发表时间：2007-10-15 20:20:16
标题：offsetTop、offsetLeft、offsetWidth、offsetHeight
4、clientLeft
返回对象的offsetLeft属性值和到当前窗口左边的真实值之间的距离，可以理解为边框的长度
一直以来对offsetLeft，offsetTop，scrollLeft，scrollTop这几个方法很迷糊，花了一天的时间好好的学习了一下．得出了以下的结果：
1.offsetTop :
当前对象到其上级层顶部的距离.
不能对其进行赋值.设置对象到页面顶部的距离请用style.top属性.
2.offsetLeft :
当前对象到其上级层左边的距离.
不能对其进行赋值.设置对象到页面左部的距离请用style.left属性.
3.offsetWidth :
当前对象的宽度.
与style.width属性的区别在于:如对象的宽度设定值为百分比宽度,则无论页面变大还是变小,style.width都返回此百分比,而offsetWidth则返回在不同页面中对象的宽度值而不是百分比值
4.offsetHeight :
与style.height属性的区别在于:如对象的宽度设定值为百分比高度,则无论页面变大还是变小,style.height都返回此百分比,而offsetHeight则返回在不同页面中对象的高度值而不是百分比值
5.offsetParent :
当前对象的上级层对象.
注意.如果对象是包括在一个DIV中时,此DIV不会被当做是此对象的上级层,(即对象的上级层会跳过DIV对象)上级层是Table时则不会有问题.
利用这个属性，可以得到当前对象在不同大小的页面中的绝对位置．
得到绝对位置脚本代码
function GetPosition(obj)</p>
<p>{</p>
<p>var left = 0;</p>
<p>var top = 0;</p>
<p>while(obj != document.body)</p>
<p>{</p>
<p>left = obj.offsetLeft;</p>
<p>top = obj.offsetTop;</p>
<p>obj = obj.offsetParent;</p>
<p>}</p>
<p>alert(&quot;Left Is : &quot; + left + “\r\n” + &quot;Top Is : &quot; + top);</p>
<p>}
6.scrollLeft :
对象的最左边到对象在当前窗口显示的范围内的左边的距离．
即是在出现了横向滚动条的情况下，滚动条拉动的距离．
7.scrollTop
对象的最顶部到对象在当前窗口显示的范围内的顶边的距离．
即是在出现了纵向滚动条的情况下，滚动条拉动的距离．
我们这里说说四种浏览器对 document.body 的 clientHeight、offsetHeight 和 scrollHeight 的解释，这里说的是 document.body，如果是 HTML 控件，则又有不同，点击这里查看。
这四种浏览器分别为IE（Internet Explorer）、NS（Netscape）、Opera、FF（FireFox）。
clientHeight
大家对 clientHeight 都没有什么异议，都认为是内容可视区域的高度，也就是说页面浏览器中可以看到内容的这个区域的高度，一般是最后一个工具条以下到状态栏以上的这个区域，与页面内容无关。
offsetHeight
IE、Opera 认为 offsetHeight = clientHeight + 滚动条 + 边框。
NS、FF 认为 offsetHeight 是网页内容实际高度，可以小于 clientHeight。
scrollHeight
IE、Opera 认为 scrollHeight 是网页内容实际高度，可以小于 clientHeight。
NS、FF 认为 scrollHeight 是网页内容高度，不过最小值是 clientHeight。
简单地说
clientHeight 就是透过浏览器看内容的这个区域高度。
NS、 FF 认为 offsetHeight 和 scrollHeight 都是网页内容高度，只不过当网页内容高度小于等于 clientHeight 时，scrollHeight 的值是 clientHeight，而 offsetHeight 可以小于 clientHeight。
IE、Opera 认为 offsetHeight 是可视区域 clientHeight 滚动条加边框。scrollHeight 则是网页内容实际高度。
同理
clientWidth、offsetWidth 和 scrollWidth 的解释与上面相同，只是把高度换成宽度即可。
说明
以 上基于 DTD HTML 4.01 Transitional，如果是 DTD XHTML 1.0 Transitional 则意义又会不同，在 XHTML 中这三个值都是同一个值，都表示内容的实际高度。新版本的浏览器大多支持根据页面指定的 DOCTYPE 来启用不同的解释器。下载或浏览测试文件。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/08/linux-bt5-wlan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/08/linux-bt5-wlan/" itemprop="url">bt5破解无线网络教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>第一部分 虚拟机的安装
下载完后，先安装虚拟机，解压
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_1.png" alt="bt5"><span class="image-caption">bt5</span>
2．进入虚拟机目录，打开
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_2.png" alt="bt5"><span class="image-caption">bt5</span>
等一下就出现这个，下来就是Next下一步点起走就行了
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_3.png" alt="bt5"><span class="image-caption">bt5</span>
这一步注册，
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_4.png" alt="bt5"><span class="image-caption">bt5</span>
打开虚拟机目录下New.keygen.exe
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_5.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_6.png" alt="bt5"><span class="image-caption">bt5</span>
复制注册码
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_7.png" alt="bt5"><span class="image-caption">bt5</span>
下一步，即可！
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_8.png" alt="bt5"><span class="image-caption">bt5</span>
最后问是否重启，点No，完成安装！
需要汉化的朋友可以运行目录下setup.exe
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_9.png" alt="bt5"><span class="image-caption">bt5</span>
汉化很简单，下一步就是，不过需要注意
汉化过程中注册有捆绑软件，不需要的，不打勾即可！
第二部分 虚拟机设置，加载ISO文件
启动桌面上的VMware Workstation!
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_10.png" alt="bt5"><span class="image-caption">bt5</span>
先新建 &gt; 虚拟机
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_11.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_12.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_13.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_14.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_15.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_16.png" alt="bt5"><span class="image-caption">bt5</span>
完成以后，主窗口就多一个选项，就是刚刚建立的
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_17.png" alt="bt5"><span class="image-caption">bt5</span>
点编辑虚拟机设置
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_18.png" alt="bt5"><span class="image-caption">bt5</span>
选CD-ROM,右下角，使用ISO镜像
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_19.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_20.png" alt="bt5"><span class="image-caption">bt5</span>
选中，bt5.iso
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_21.png" alt="bt5"><span class="image-caption">bt5</span>
确定后，点启动虚拟机
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_22.png" alt="bt5"><span class="image-caption">bt5</span>
启动时间大约40秒，看你计算机的配置怎么样
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_23.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_24.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_25.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_26.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_27.png" alt="bt5"><span class="image-caption">bt5</span>
解决办法：
虚拟机 &gt; 可移动设备 &gt; USB设备  &gt; Realtek Usb设备
选的是你的网卡，有可能名字不一样，选择你的那个网卡就可以了！
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_28.png" alt="bt5"><span class="image-caption">bt5</span>
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_29.png" alt="bt5"><span class="image-caption">bt5</span>
再次启动软件就不会提供没有网卡了不
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_30.png" alt="bt5"><span class="image-caption">bt5</span>
提示：破解的时候把方式选择那里的所有方式都选上，这样可以提供破解成功率！
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_31.png" alt="bt5"><span class="image-caption">bt5</span>
****密码出来了
<img src="http://7xlbo3.com1.z0.glb.clouddn.com/2013/01/08/bt5_32.png" alt="bt5"><span class="image-caption">bt5</span>
Hex key就是密码 6161613132 成功了！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/07/java-hibernate-could-not-initialize-proxy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/07/java-hibernate-could-not-initialize-proxy/" itemprop="url">could not initialize proxy – no Session</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>在<code>&lt;many-to-on&gt;</code>中这错误很常见，字面意义就是不能被初始化，因为<code>session</code>已经关闭了。
简单理解就是因为，你使用了<code>lazy=true</code>，这样hibernate在从数据库中调数据的时候是不会把关联的对象查出来的，而是保存一个获取值得方法，在你使用getXXX()调用的时候，hiberante会利用这个保存的方法去从数据库中取数据。而往往我们在jsp页面中使用getXXX()准备展示数据的时候，session早已经在dao中就关闭了，我们该如何解决这种异常呢？
简单的说有三种：</p>
<ol>
<li>把lazy设成false,最简单。</li>
<li>我没试过，但听说过</li>
</ol>
<p>在web.xml中加入</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line">&lt;<span class="attribute">filter</span>&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-name&gt;hibernateFilter&lt;/filter-name&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-class&gt; </div><div class="line">     org<span class="selector-class">.springframework</span><span class="selector-class">.orm</span><span class="selector-class">.hibernate3</span><span class="selector-class">.support</span><span class="selector-class">.OpenSessionInViewFilter</span> </div><div class="line">     &lt;/<span class="attribute">filter</span>-class&gt; </div><div class="line">&lt;/<span class="attribute">filter</span>&gt; </div><div class="line">&lt;<span class="attribute">filter</span>-mapping&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-name&gt;hibernateFilter&lt;/filter-name&gt; </div><div class="line">     &lt;url-pattern&gt;*.do&lt;/url-pattern&gt; </div><div class="line">&lt;/<span class="attribute">filter</span>-mapping&gt;</div></pre></td></tr></table></figure>
<ol start="3">
<li>我用的方法，也是我认为比较不错的方法，灵活性更好。用left join fetch或inner join fetch语法。
例如：from Item i left join fetch i.parentItem ii
解释一下Item表是一个自关联的表，它的关联关系在hbm.xml中配置好了。
如下：</li>
</ol>
<p>程序代码</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><div class="line">&lt;many-<span class="keyword">to</span>-one <span class="built_in">name</span>=<span class="string">"parentItem"</span> lazy=<span class="string">"false"</span> fetch=<span class="string">"join"</span> <span class="built_in">class</span>=<span class="string">"cn.sports.matchs.model.Item"</span>&gt; </div><div class="line">             &lt;column <span class="built_in">name</span>=<span class="string">"PARENT_ID"</span>&gt;&lt;/column&gt; </div><div class="line">&lt;/many-<span class="keyword">to</span>-one&gt;</div></pre></td></tr></table></figure>
<p>在Item类中</p>
<p>程序代码</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><div class="line">private Item parentItem<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>关于lazy机制：
延迟初始化错误是运用Hibernate开发项目时最常见的错误。如果对一个类或者集合配置了延迟检索策略，那么必须当代理类实例或代理集合处于持久化状态（即处于Session范围内）时，才能初始化它。如果在游离状态时才初始化它，就会产生延迟初始化错误。</p>
<p>下面把Customer.hbm.xml文件的<class>元素的lazy属性设为true，表示使用延迟检索策略：</class></p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><div class="line">&lt;<span class="built_in">class</span> <span class="built_in">name</span>=<span class="string">"mypack.Customer"</span> table=<span class="string">"CUSTOMERS"</span> lazy=<span class="string">"true"</span>&gt;</div></pre></td></tr></table></figure>
<p>当执行Session的load()方法时，Hibernate不会立即执行查询CUSTOMERS表的select语句，仅仅返回Customer类的代理类的实例，这个代理类具由以下特征：
（1）由Hibernate在运行时动态生成，它扩展了Customer类，因此它继承了Customer类的所有属性和方法，但它的实现对于应用程序是透明的。
（2）当Hibernate创建Customer代理类实例时，仅仅初始化了它的OID属性，其他属性都为null，因此这个代理类实例占用的内存很少。
（3）当应用程序第一次访问Customer代理类实例时（例如调用customer.getXXX()或customer.setXXX()方法）， Hibernate会初始化代理类实例，在初始化过程中执行select语句，真正从数据库中加载Customer对象的所有数据。但有个例外，那就是当应用程序访问Customer代理类实例的getId()方法时，Hibernate不会初始化代理类实例，因为在创建代理类实例时OID就存在了，不必到数据库中去查询。
提示：Hibernate采用CGLIB工具来生成持久化类的代理类。CGLIB是一个功能强大的Java字节码生成工具，它能够在程序运行时动态生成扩展 Java类或者实现Java接口的代理类。关于CGLIB的更多知识，请参考：<a href="http://cglib.sourceforge.net/%E3%80%82" target="_blank" rel="external">http://cglib.sourceforge.net/。</a>
以下代码先通过Session的load()方法加载Customer对象，然后访问它的name属性：</p>
<figure class="highlight pony"><table><tr><td class="code"><pre><div class="line">tx = session.beginTransaction(); </div><div class="line"><span class="type">Customer</span> customer=(<span class="type">Customer</span>)session.load(<span class="type">Customer</span>.<span class="keyword">class</span>,<span class="function"><span class="keyword">new</span> <span class="title">Long</span>(<span class="number">1</span>)); </span></div><div class="line"><span class="title">customer</span>.<span class="title">getName</span>(); </div><div class="line"><span class="title">tx</span>.<span class="title">commit</span>();</div></pre></td></tr></table></figure>
<p>在运行session.load()方法时Hibernate不执行任何select语句，仅仅返回Customer类的代理类的实例，它的OID为1，这是由load()方法的第二个参数指定的。当应用程序调用customer.getName()方法时，Hibernate会初始化Customer代理类实例，从数据库中加载Customer对象的数据，执行以下select语句：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> CUSTOMERS <span class="keyword">where</span> <span class="keyword">ID</span>=<span class="number">1</span>; </div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> orDERS <span class="keyword">where</span> CUSTOMER_ID=<span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>当<class>元素的lazy属性为true，会影响Session的load()方法的各种运行时行为，下面举例说明。
1．如果加载的Customer对象在数据库中不存在，Session的load()方法不会抛出异常，只有当运行customer.getName()方法时才会抛出以下异常：</class></p>
<blockquote>
<p>ERROR LazyInitializer:63 -Exception initializing proxy
net.sf.hibernate.ObjectNotFoundException: No row with thegiven identifier exists: 1, of class:
mypack.Customer
2．如果在整个Session范围内，应用程序没有访问过Customer对象，那么Customer代理类的实例一直不会被初始化，Hibernate不会执行任何select语句。以下代码试图在关闭Session后访问Customer游离对象：</p>
</blockquote>
<figure class="highlight pony"><table><tr><td class="code"><pre><div class="line">tx = session.beginTransaction(); </div><div class="line"><span class="type">Customer</span> customer=(<span class="type">Customer</span>)session.load(<span class="type">Customer</span>.<span class="keyword">class</span>,<span class="function"><span class="keyword">new</span> <span class="title">Long</span>(<span class="number">1</span>)); </span></div><div class="line"><span class="title">tx</span>.<span class="title">commit</span>(); </div><div class="line"><span class="title">session</span>.<span class="title">close</span>(); </div><div class="line"><span class="title">customer</span>.<span class="title">getName</span>();</div></pre></td></tr></table></figure>
<p>由于引用变量customer引用的Customer代理类的实例在Session范围内始终没有被初始化，因此在执行customer.getName()方法时，Hibernate会抛出以下异常：
ERROR LazyInitializer:63 -Exception initializing proxy
net.sf.hibernate.HibernateException: Couldnotinitializeproxy-theowningSessionwasclosed
由此可见，Customer代理类的实例只有在当前Session范围内才能被初始化。</p>
<p>3．net.sf.hibernate.Hibernate类的initialize()静态方法用于在Session范围内显式初始化代理类实例，isInitialized()方法用于判断代理类实例是否已经被初始化。例如：</p>
<figure class="highlight pony"><table><tr><td class="code"><pre><div class="line">tx = session.beginTransaction(); </div><div class="line"><span class="type">Customer</span> customer=(<span class="type">Customer</span>)session.load(<span class="type">Customer</span>.<span class="keyword">class</span>,<span class="function"><span class="keyword">new</span> <span class="title">Long</span>(<span class="number">1</span>)); </span></div><div class="line"><span class="title">if</span>(!<span class="type">Hibernate</span>.isInitialized(customer)) </div><div class="line"><span class="title">Hibernate</span>.<span class="title">initialize</span>(customer); </div><div class="line"><span class="title">tx</span>.<span class="title">commit</span>(); </div><div class="line"><span class="title">session</span>.<span class="title">close</span>(); </div><div class="line"><span class="title">customer</span>.<span class="title">getName</span>();</div></pre></td></tr></table></figure>
<p>以上代码在Session范围内通过Hibernate类的initialize()方法显式初始化了Customer代理类实例，因此当Session关闭后，可以正常访问Customer游离对象。</p>
<p>4．当应用程序访问代理类实例的getId()方法时，不会触发Hibernate初始化代理类实例的行为，例如：</p>
<figure class="highlight pony"><table><tr><td class="code"><pre><div class="line">tx = session.beginTransaction(); </div><div class="line"><span class="type">Customer</span> customer=(<span class="type">Customer</span>)session.load(<span class="type">Customer</span>.<span class="keyword">class</span>,<span class="function"><span class="keyword">new</span> <span class="title">Long</span>(<span class="number">1</span>)); </span></div><div class="line"><span class="title">customer</span>.<span class="title">getId</span>(); </div><div class="line"><span class="title">tx</span>.<span class="title">commit</span>(); </div><div class="line"><span class="title">session</span>.<span class="title">close</span>(); </div><div class="line"><span class="title">customer</span>.<span class="title">getName</span>();</div></pre></td></tr></table></figure>
<p>当应用程序访问customer.getId()方法时，该方法直接返回Customer代理类实例的OID值，无需查询数据库。由于引用变量 customer始终引用的是没有被初始化的Customer代理类实例，因此当Session关闭后再执行customer.getName()方法， Hibernate会抛出以下异常：</p>
<blockquote>
<p>ERROR LazyInitializer:63 -Exception initializing proxy
net.sf.hibernate.HibernateException: Couldnotinitializeproxy-theowningSessionwasclosed</p>
</blockquote>
<p>解决方法：
由于hibernate采用了lazy=true,这样当你用hibernate查询时,返回实际为利用cglib增强的代理类,但其并没有实际填充;当你在前端,利用它来取值(getXXX)时,这时Hibernate才会到数据库执行查询,并填充对象,但此时如果和这个代理类相关的session已关闭掉,就会产生种错误.
在做一对多时，有时会出现&quot;could not initialize proxy – clothe owning Session was sed,这个好像是hibernate的缓存问题.问题解决:需要在<many-to-one>里设置lazy=“false”. 但有可能会引发另一个异常叫
failed to lazily initialize a collection of role: XXXXXXXX, no session or session was closed
解决方法:在web.xml中加入</many-to-one></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line">&lt;<span class="attribute">filter</span>&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-name&gt;hibernateFilter&lt;/filter-name&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-class&gt; </div><div class="line">     org<span class="selector-class">.springframework</span><span class="selector-class">.orm</span><span class="selector-class">.hibernate3</span><span class="selector-class">.support</span><span class="selector-class">.OpenSessionInViewFilter</span> </div><div class="line">     &lt;/<span class="attribute">filter</span>-class&gt; </div><div class="line">&lt;/<span class="attribute">filter</span> &gt; </div><div class="line">&lt;<span class="attribute">filter</span>-mapping&gt; </div><div class="line">     &lt;<span class="attribute">filter</span>-name&gt;hibernateFilter&lt;/filter-name&gt; </div><div class="line">     &lt;url-pattern&gt;*.do&lt;/url-pattern&gt; </div><div class="line">&lt;/<span class="attribute">filter</span>-mapping&gt;</div></pre></td></tr></table></figure>
<p>就可以了;</p>
<p>参考了:
Hibernate与延迟加载：
Hibernate对象关系映射提供延迟的与非延迟的对象初始化。非延迟加载在读取一个对象的时候会将与这个对象所有相关的其他对象一起读取出来。这有时会导致成百的（如果不是成千的话）select语句在读取对象的时候执行。这个问题有时出现在使用双向关系的时候，经常会导致整个数据库都在初始化的阶段被读出来了。当然，你可以不厌其烦地检查每一个对象与其他对象的关系，并把那些最昂贵的删除，但是到最后，我们可能会因此失去了本想在ORM工具中获得的便利。
一个明显的解决方法是使用Hibernate提供的延迟加载机制。这种初始化策略只在一个对象调用它的一对多或多对多关系时才将关系对象读取出来。这个过程对开发者来说是透明的，而且只进行了很少的数据库操作请求，因此会得到比较明显的性能提升。这项技术的一个缺陷是延迟加载技术要求一个Hibernate会话要在对象使用的时候一直开着。这会成为通过使用DAO模式将持久层抽象出来时的一个主要问题。为了将持久化机制完全地抽象出来，所有的数据库逻辑，包括打开或关闭会话，都不能在应用层出现。最常见的是，一些实现了简单接口的DAO实现类将数据库逻辑完全封装起来了。一种快速但是笨拙的解决方法是放弃DAO模式，将数据库连接逻辑加到应用层中来。这可能对一些小的应用程序有效，但是在大的系统中，这是一个严重的设计缺陷，妨碍了系统的可扩展性。
在Web层进行延迟加载
幸运的是，Spring框架为Hibernate延迟加载与DAO模式的整合提供了一种方便的解决方法。对那些不熟悉Spring与Hibernate集成使用的人，我不会在这里讨论过多的细节，但是我建议你去了解Hibernate与Spring集成的数据访问。以一个Web应用为例，Spring提供了OpenSessionInViewFilter和OpenSessionInViewInterceptor。我们可以随意选择一个类来实现相同的功能。两种方法唯一的不同就在于interceptor在Spring容器中运行并被配置在web应用的上下文中，而Filter在Spring之前运行并被配置在web.xml中。不管用哪个，他们都在请求将当前会话与当前（数据库）线程绑定时打开Hibernate会话。一旦已绑定到线程，这个打开了的Hibernate会话可以在DAO实现类中透明地使用。这个会话会为延迟加载数据库中值对象的视图保持打开状态。一旦这个逻辑视图完成了，Hibernate会话会在Filter的doFilter方法或者Interceptor的postHandle方法中被关闭。下面是每个组件的配置示例：
Interceptor的配置:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">&lt;bean name=<span class="string">"openSessionInViewInterceptor"</span> </div><div class="line"><span class="class"><span class="keyword">class</span></span>=<span class="string">"org.springframework.orm.hibernate.support.OpenSessionInViewInterceptor"</span>&gt; </div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span>&gt;</span><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"sessionFactory"</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </div><div class="line">&lt;<span class="regexp">/beans&gt;</span></div></pre></td></tr></table></figure>
<p>Filter的配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hibernateFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">filter-class</span>&gt;</span> </div><div class="line">org.springframework.orm.hibernate.support.OpenSessionInViewFilter </div><div class="line"><span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hibernateFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*. spring <span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></div></pre></td></tr></table></figure>
<p>实现Hibernate的Dao接口来使用打开的会话是很容易的。事实上，如果你已经使用了Spring框架来实现你的Hibernate Dao,很可能你不需要改变任何东西。方便的HibernateTemplate公用组件使访问数据库变成小菜一碟，而DAO接口只有通过这个组件才可以访问到数据库。下面是一个示例的DAO：</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> HibernateProductDAO <span class="keyword">extends</span> HibernateDaoSupport implements ProductDAO &#123;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="built_in">Product</span> getProduct(<span class="keyword">Integer</span> productId) &#123; </div><div class="line">       <span class="keyword">return</span> (<span class="built_in">Product</span>)getHibernateTemplate().load(<span class="built_in">Product</span>.<span class="keyword">class</span>, productId); </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">Integer</span> saveProduct(<span class="built_in">Product</span> <span class="built_in">product</span>) &#123; </div><div class="line">       <span class="keyword">return</span> (<span class="keyword">Integer</span>) getHibernateTemplate().<span class="keyword">save</span>(<span class="built_in">product</span>); </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> void updateProduct(<span class="built_in">Product</span> <span class="built_in">product</span>) &#123; </div><div class="line">       getHibernateTemplate().update(<span class="built_in">product</span>); </div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在业务逻辑层中使用延迟加载
即使在视图外面，Spring框架也通过使用AOP 拦截器 HibernateInterceptor来使得延迟加载变得很容易实现。这个Hibernate 拦截器透明地将调用配置在Spring应用程序上下文中的业务对象中方法的请求拦截下来，在调用方法之前打开一个Hibernate会话，然后在方法执行完之后将会话关闭。让我们来看一个简单的例子，假设我们有一个接口BussinessObject：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span>     <span class="keyword">interface</span>     <span class="title">BusinessObject</span>     &#123; </div><div class="line"><span class="function"><span class="keyword">public</span>     <span class="keyword">void</span>     <span class="title">doSomethingThatInvolvesDaos</span>(<span class="params"></span>)</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>类BusinessObjectImpl实现了BusinessObject接口:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span>     <span class="class"><span class="keyword">class</span>     <span class="title">BusinessObjectImpl</span>     <span class="keyword">implements</span>     <span class="title">BusinessObject</span>     </span>&#123; </div><div class="line"><span class="function"><span class="keyword">public</span>     <span class="keyword">void</span>     <span class="title">doSomethingThatInvolvesDaos</span><span class="params">()</span>     </span>&#123; </div><div class="line"><span class="comment">//     lots of logic that calls </span></div><div class="line"><span class="comment">//     DAO classes Which access </span></div><div class="line"><span class="comment">//     data objects lazily  </span></div><div class="line">&#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过在Spring应用程序上下文中的一些配置，我们可以让将调用BusinessObject的方法拦截下来，再令它的方法支持延迟加载。看看下面的一个程序片段：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"hibernateInterceptor"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate.HibernateInterceptor"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"sessionFactory"</span>/&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"businessObjectTarget"</span> <span class="attr">class</span>=<span class="string">"com.acompany.BusinessObjectImpl"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"someDAO"</span>&gt;</span><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"someDAO"</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"businessObject"</span> <span class="attr">class</span>=<span class="string">"org.springframework.aop.framework.ProxyFactoryBean"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"target"</span>&gt;</span><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"businessObjectTarget"</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"proxyInterfaces"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>com.acompany.BusinessObject<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"interceptorNames"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">list</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hibernateInterceptor<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">list</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<p>当businessObject被调用的时候，HibernateInterceptor打开一个Hibernate会话，并将调用请求传递给BusinessObjectImpl对象。当BusinessObjectImpl执行完成后，HibernateInterceptor透明地关闭了会话。应用层的代码不用了解任何持久层逻辑，还是实现了延迟加载。
在单元测试中测试延迟加载
最后，我们需要用J-Unit来测试我们的延迟加载程序。我们可以轻易地通过重写TestCase类中的setUp和tearDown方法来实现这个要求。我比较喜欢用这个方便的抽象类作为我所有测试类的基类。</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><div class="line">public <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLazyTestCase</span> <span class="keyword">extends</span> <span class="title">TestCase</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="type">SessionFactory</span> sessionFactory; </div><div class="line"><span class="keyword">private</span> <span class="type">Session</span> session;</div><div class="line"></div><div class="line">public void setUp() <span class="keyword">throws</span> <span class="type">Exception</span> &#123; </div><div class="line"><span class="keyword">super</span>.setUp(); </div><div class="line"><span class="type">SessionFactory</span> sessionFactory = (<span class="type">SessionFactory</span>) getBean(<span class="string">"sessionFactory"</span>); </div><div class="line">session = <span class="type">SessionFactoryUtils</span>.getSession(sessionFactory, <span class="literal">true</span>); </div><div class="line"><span class="type">Session</span> s = sessionFactory.openSession(); </div><div class="line"><span class="type">TransactionSynchronizationManager</span>.bindResource(sessionFactory, <span class="keyword">new</span> <span class="type">SessionHolder</span>(s));</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">protected</span> <span class="type">Object</span> getBean(<span class="type">String</span> beanName) &#123; </div><div class="line"><span class="comment">//Code to get objects from Spring application context </span></div><div class="line">&#125;</div><div class="line"></div><div class="line">public void tearDown() <span class="keyword">throws</span> <span class="type">Exception</span> &#123; </div><div class="line"><span class="keyword">super</span>.tearDown(); </div><div class="line"><span class="type">SessionHolder</span> holder = (<span class="type">SessionHolder</span>) <span class="type">TransactionSynchronizationManager</span>.getResource(sessionFactory); </div><div class="line"><span class="type">Session</span> s = holder.getSession(); </div><div class="line">s.flush(); </div><div class="line"><span class="type">TransactionSynchronizationManager</span>.unbindResource(sessionFactory); </div><div class="line"><span class="type">SessionFactoryUtils</span>.closeSessionIfNecessary(s, sessionFactory); </div><div class="line">&#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们首先说利用lazy=false来解决问题，这种方法是很好用，但是在实际的过程并不实用，如果你某个对象关联好几个甚至十几个自对象，那么每次加载一个的话要执行很多HQL语句，可想而知这个效率问题啦，特别是在使用列表的时候。所以不实用，而在上述所说的“在业务逻辑层中使用延迟加载” 也是这种情况吧。
很多使用WEB的朋友都喜欢利用openSessionView来加载这个问题。不错我也喜欢用，简单方便。但是说几种情况：</p>
<ol>
<li>在quartz中总不能使用openSessionView模式吧</li>
<li>在spring后拦截的过程中，如果取拦截对象中的子对象利用openSessionView也不行
还有很多情况是不能用的，那么怎么解决呢。有人说那就lazy=False吧，你想在单纯的解决一个quartz的时候调整整个WEB工程的加载好像不合适吧。
那怎么办呢，我觉得这个时候就可以考虑利用SQL语句使用这个重新加载一遍这个代理类，这样在想调用的时候才手动加载比较合适和方便吧，但是估计要多几行代码，好好考虑</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/07/system-ie-toolbar-plugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/07/system-ie-toolbar-plugin/" itemprop="url">IE工具栏上添加自己的按钮</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><h1 id="问题提出"><a class="header-anchor" href="#问题提出"> </a>问题提出</h1>
<p>金山词霸、网络蚂蚁等软件安装后会向IE的工具条添加自己的按钮。按下按钮后还会作出相应的动作，这种功能是如何实现的呢？读完本文，您也可以将自己应用程序的按钮添加到IE的工具条中。</p>
<h1 id="基本原理"><a class="header-anchor" href="#基本原理"> </a>基本原理</h1>
<p>从IE5开始便允许我们向工具栏添加自己的按钮，其本质就是修改注册表，添加创建此按钮所需的信息。</p>
<h1 id="实现步骤"><a class="header-anchor" href="#实现步骤"> </a>实现步骤</h1>
<ol>
<li>创建此按钮的GUID(globally unique identifier)
你可以通过<code>Visual Studio</code>中的<code>Guidgen.exe</code>来产生GUID。
例如我生成的GUID是<code>{1FBA04EE-3024-11D2-8F1F-0000F87ABD16}</code>
以下的例子中我都使用这个GUID来作说明。</li>
<li>创建子键HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\Extensions{1FBA04EE-3024-11D2-8F1F-0000F87ABD16}</li>
<li>在此子键下创建如下字串值。
（1）CLSID
这是IE的CLSID，其值必须为{1FBA04EE-3024-11D2-8F1F-0000F87ABD16}
（2）Default Visible
指明此按钮默认状态下是否可见，Yes表示可见,No为不可见
（3）ButtonText
按钮文字
（4）Icon
默认状态下的图标全路径，例如c:\vckbase.ico。也可以是EXE文件中包含的图标，例如：C:\PROGRA~1\NETANTS\NetAnts.exe,1000
（5）HotIcon
鼠标移到按钮上时的图标全路径
如下子键为按下按钮后需要执行的相应动作：可以是COM对象、浏览条Explorer Bar、脚本Script、可执行文件。
下面我们逐个进行介绍。
①COM对象
你需要建立名为ClsidExtension的字串值，其值应该为此COM对象的GUID
例如金山词霸就使用ClsidExtension来调用自己的COM对象。
②浏览条Explorer Bar
所谓浏览条就是类似我们按下往IE历史按钮后打开的历史记录列表，其本质好比MFC中的CReBar对象。 浏览条也可以自己制作，
因为超出了本文的范围，暂不作讲解。
为了在按下按钮后打开一个浏览条，你需要建立名为BandCLSID的字串值，其值为浏览条的CLSID
③脚本Script
按下按钮后执行的脚本，例如：&quot;%SystemRoot%\web\related.htm&quot;
你可以在这个HTML文件里面加上脚本来得到IE当前的许多信息，需要注意的是假如你想通过Script打开非脚本的HTML文件是不可行的。
请参考如下NetAnts取得当前页所有链接的脚本代码</li>
</ol>
<script language="VBScript"> 
－－On Error Resume Next 
－－set NetAntsApi = CreateObject( "NetAnts.API" ) 
－－if err<>0 then 
－－ －－Alert("NetAnts not properly installed on this PC!") 
－－else 
－－ －－set links = external.menuArguments.document.links 
－－ －－ReDim params(links.length*2) 
－－ －－params(0)=external.menuArguments.document.Url 
－－ －－for i = 0 to links.length-1 
－－ －－ －－params(i*2+1)=links(i).href 
－－ －－ －－params(i*2+2)=links(i).innerText 
－－ －－next 
－－ －－NetAntsApi.AddUrlList params 
－－end if 
< /script> 
我们再看一个比较有用的脚本,这段脚本的作用是得到当前地址，并打开此网址的首页。 
<script> 
－－//userURL得到的是当前地址,例如是http://www.vckbase.com/article/controls/index.html 
－－userURL=external.menuArguments.location.href; 
－－protocolIndex=userURL.indexOf("://",4); 
－－serverIndex=userURL.indexOf("/",protocolIndex + 3); 
－－finalURL=userURL.substring(0,serverIndex); 
－－external.menuArguments.open(finalURL, "_blank");///打开网址http://www.vckbase.com/ 
< /script> 
关于external等对象的具体使用方法请参阅微软的《动态HTML开发参考大全》–人民邮电出版社出版 
④可执行文件 
假如我们想让IE在按下按钮后执行一个可执行文件, 你可以增加名为Exec的字串值，其值为此可执行文件的全路径， 
例如c:\windows\notepad.exe或者是一个网址http://www.vckbase.com/index.html 
下面我们介绍一个简单的例子。 
void CIEButtonDlg::OnAdd() 
{ 
－－///这是由GUIDGEN产生的GUID：{06926B30-424E-4f1c-8EE3-543CD96573DC} 
－－CRegKey reg; 
－－char KeyName[]="Software\\Microsoft\\Internet Explorer\\Extensions\\{06926B30-424E-4f1c-8EE3-543CD96573DC}"; 
－－TCHAR PathName[MAX_PATH]; 
－－TCHAR IconPathName[MAX_PATH]; ///正常时的图标全路径 
－－TCHAR HotIconPathName[MAX_PATH]; ///鼠标覆盖时的图标全路径 
－－GetModuleFileName(0,PathName,MAX_PATH); ///得到本可执行文件的路径 
－－strcpy(IconPathName,PathName); 
－－strcpy(HotIconPathName,PathName); 
－－strcat(HotIconPathName,",131"); ///131是图标的ID，你可以以资源方式打开EXE文件就可以看到所有资源及其ID 
－－strcat(IconPathName,",129"); 
－－reg.Create(HKEY_LOCAL_MACHINE,KeyName); 
－－reg.SetValue("{1FBA04EE-3024-11D2-8F1F-0000F87ABD16}","CLSID"); 
－－reg.SetValue("Yes","Default Visible"); 
－－reg.SetValue("VC知识库","ButtonText"); 
－－reg.SetValue(IconPathName,"Icon"); 
－－reg.SetValue(HotIconPathName,"HotIcon"); 
－－/////假如是执行脚本，可以是reg.SetValue("c:\\test.html","Script"); ///在test.html 存放你的脚本代码
－－reg.SetValue("http://www.vckbase.com/","Exec");///打开网页 
}
</script>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/05/linux-ubuntu-ssh-server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/05/linux-ubuntu-ssh-server/" itemprop="url">ubuntu开启ssh服务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>网上有很多介绍在Ubuntu下开启SSH服务的文章，但大多数介绍的方法测试后都不太理想，均不能实现远程登录到Ubuntu上，最后分析原因是都没有真正开启ssh-server服务。最终成功的方法如下：
sudo apt-get install openssh-server
Ubuntu缺省安装了openssh-client,所以在这里就不安装了，如果你的系统没有安装的话，再用apt-get安装上即可。
然后确认sshserver是否启动了：
ps -e |grep ssh
如果只有ssh-agent那ssh-server还没有启动，需要/etc/init.d/ssh start，如果看到sshd那说明ssh-server已经启动了。
ssh-server配置文件位于/ etc/ssh/sshd_config，在这里可以定义SSH的服务端口，默认端口是22，你可以自己定义成其他端口号，如222。然后重启SSH服务：
sudo /etc/init.d/ssh resar
ssh连接：ssh <a href="mailto:xjtu129@202.117.15.165" target="_blank" rel="external">xjtu129@202.117.15.165</a>
————————————————-</p>
<ol>
<li>首先在服务器上安装ssh的服务器端。
$ sudo aptitude install openssh-server</li>
<li>启动ssh-server。
$ /etc/init.d/ssh restart</li>
<li>确认ssh-server已经正常工作。
$ netstat -tlp
tcp6 0 0 *:ssh <em>:</em> LISTEN –
看到上面这一行输出说明ssh-server已经在运行了。</li>
<li>在客户端通过ssh登录服务器。假设服务器的IP地址是192.168.0.103，登录的用户名是hyx。
$ ssh -l hyx 192.168.0.103
接下来会提示输入密码，然后就能成功登录到服务器上了</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/05/software-editplus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/05/software-editplus/" itemprop="url">使用EditPlus技巧，提高工作效率(附英文版、自动完成文件、语法文件下载)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>除了windows操作系统，EditPlus可以说是我最经常使用的软件了。无论是编写xhtml页面，还是css、js文件，甚至随笔记记这样的事情，我都会使用EditPlus（现在使用的是EditPlus2.31英文版），感觉它不仅功能强大，更难得的是：绿色、轻量级、启动速度快、稳定性高……反正，我个人是爱死她了！</p>
<p>在使用中，我个人也总结了一些使用经验。可能作为高手的你，看来只是“相当肤浅”，但是没有关系，因为我相信，只要把知识共享出来，总能帮助到一些还在进步中的朋友。下面就让我们来开始配置出符合你自己使用习惯的EditPlus吧！</p>
<p>2008-05-08补充：同时推荐大家阅读这篇《“阿一web标准学堂”选修课：EditPlus高级使用技巧（附视频、课件、代码下载）》，有视频哦。</p>
<p>一边阅读，一边动手吧！</p>
<p>为了达到更好的效果，请你先下载我打包的这个 EditPlus压缩包文件（压缩包文件为绿色的EditPlus2.31英文版,含自动完成文件,高亮语法文件和剪切板代码片断文件，这些文件在解压目录下的&quot;yzyFile&quot;目录下），这样就可以一边看着这篇文章，一边亲自动手，从而达到更好的效果了。</p>
<p>设置EditPlus的配置文件路径</p>
<p>因为EditPlus是可以绿色使用的（直接解压那个EditPlus压缩包文件即可直接使用，不用安装），所以，当我们对EditPlus进行一系列的配置以后，保存下这些配置文件。以后当我们重装系统，或者换台电脑使用的时候，只要重新加载一下那些配置文件，以前的配置就都重新回来了，很是方便。所以，在讲其他配置和技巧之前，我们先设置好EditPlus的配置文件路径。</p>
<p>打开EditPlus → 【Tools】→ 【INI File Directory…】 → 在弹出的对话框中设置配置文件的保存位置（压缩包内的配置保存文件在解压目录下的&quot;yzyFileINIFiles&quot;目录下）。这里你可能要重新设置一下目录，因为，我喜欢把EditPlus放在&quot;D:GreenSoftEditPlus 2&quot;下（把所有的绿色软件装在一个目录下，每次重装系统的时候，可以直接把绿色软件拷回去，就能直接使用了，从而避免了每次都安装那么多软件）。所以，就请你重新设置一下，根据你的习惯，把配置文件存放在某个目录下吧。</p>
<p>web标准设计
图1：设置EditPlus的配置文件保存路径</p>
<p>保护视力，从EditPlus做起</p>
<p>“最近眼睛好痛呀！”、“靠～眼睛简直要瞎了！”……不知道作为程序员的你是否也经常抱怨这样的事情，每天对着电脑看，的确对视力的伤害很大，所以能不能采取一些措施来为眼睛减减压呢？我在EditPlus里面是这样做的（因为EditPlus是我最长使用的工具，所以以EditPlus为例）——编辑区的背景设为灰色而不是默认的白色，使用较大字号的字体。效果如下图所示：</p>
<p>web标准设计
图2：灰色的背景，12号的雅黑字体，构造“爱眼”环境</p>
<p>你可以这样设置EditPlus编辑环境的背景颜色和字体。菜单【Tools】→ 【Preperences】→ 【General】→ 【fonts】和【colors】。需要说明一下的是：可以设置多种fonts，这样就可以很方便地切换fonts了（参看图2所示），这招对日企这样的朋友很方便哦。中文的字体设置几个，日文的字体设置几个，出现乱码的时候，切换一下字体就可以了。</p>
<p>web标准设计
图3：设置EditPlus的字体和颜色</p>
<p>配置文件模板，告别重复的体力劳动</p>
<p>设置好EditPlus的配置文件，就让我们开始EditPlus的使用技巧吧。第一个技巧当然就是和“新建”有关的啦。如果我们经常建立一种文件，而这种文件总会包含一些重复的文字或者代码的话，我们就可以建立模板，然后通过模板建立文件。从而摆脱每次都要重复的体力劳动。</p>
<p>我们就从建立一个属于自己的xhtml文件开始吧。菜单【File】→ 【New】→ 【Configure templates…】→ 在打开的对话框中“填上”菜单中显示的文字，已经模板文件的路径，就可以了。下次当你再次选择【File】→ 【New】的时候，就能够看到你建立的模板了。</p>
<p>web标准设计
图4：EditPlus中建立自己的模板</p>
<p>模板文件要怎么建立呢？其实很简单呀。举个很简单的例子，如果我想建立一个我自己的xhtml页面，模板文件就可以写成这样——</p>
<p>我的XHTML模板页面</p>
<!DOCTYPE html public "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="Keywords" content="YES!B/S!,JustinYoung,web标准设计"> 
<meta name="Description" content="This page is from http://Justinyoung.cnblogs.com"> 
<title>简单的XHTML页面</title> 
</head> 
<body> 
^! 
</body> 
</html>
<p>显然里面的Keywords和Description，意见title的内容都已经变成我常用的了。还有一点，请大家注意第10行的“^!”标签。这个标签在EditPlus中表示光标所在位置。显然，这里的意思就是：当你用这个模板建立一个新的文件的时候，光标就会自动停留在<body>和</body>之间，从而方便你的直接输入。</p>
<p>关于模板文件再说两句：</p>
<p>1：在我提供的那个 EditPlus压缩包文件中，模板文件存放在解压目录下的“yzyFileTemplates”文件夹下。</p>
<p>2：我们知道使用快捷键“Ctrl + Shift + N”可以快速的建立一个html页面，而这个可以快速的建立html的模板，位于EditPlus目录下的，文件名为“templatex.html”。你可以通过修改这个模板文件，来达到你个性化html页面的目的。</p>
<p>顺手的侧边栏</p>
<p>如果你看不到侧边栏，可以使用快捷键（Alt + Shift + 1）。侧边栏包含了“快速目录路径”和“快速剪贴板”功能。“快速目录路径”就不说了，重点来说说“快速剪贴板”功能吧。其实说白了，就是一个地方，这个地方可以存放一些代码片断、常用文言等等文字。当你需要这些文字的时候，只要双击，就可以方便的添加到光标所在位置了。默认情况下会有一些html，css代码，但是，说实话，我是不太经常使用那些东西的，那么多，找到都累死了。所以，我喜欢建立一个自己最常用的“剪贴板”库，因为是自己建的，所以用着就会比较顺手了。</p>
<p>你可以通过这种方式来建立自己的“剪贴板”库文件。在Cliptext侧边栏上的下拉列表框上点击右键 → 新建 → 填写文件名和显示标题→ 在新建的空白侧边栏上点击右键 → 新建 → 填入显示文本和代码即可。</p>
<p>关于“剪贴板”库文件再说两句：</p>
<p>1：在我提供的那个 EditPlus压缩包文件中“剪贴板”库文件存放在解压目录下的“yzyFileCliptextLibrary”文件夹下。</p>
<p>2：你可以通过直接编辑，解压目录下的“yzyFileCliptextLibrary”文件夹下的“剪贴板”库文件，来快速的建立自己的常用代码库（用EditPlus就可以打开，格式看一下就懂了。编辑好以后要重新“Reload”一下，或者重新启动一下才能刷新哦）。</p>
<p>3：侧边栏可以放在左边，也可以放在右面。设置的方法是：在侧边栏点击鼠标右键 → 选择【Location】菜单内的left或者right。</p>
<p>华丽的自动完成功能</p>
<ul> 
<li><a href="" title=""></a></li> 
<li><a href="" title=""></a></li> 
<li><a href="" title=""></a></li> 
<li><a href="" title=""></a></li> 
<li><a href="" title=""></a></li> 
</ul>
<p>可以说是俺最喜欢的功能了。想象一下，作为一个经常制作网页的人来所，当你打一个“ua”字，然后按下空格，编辑器里面就出现了右边的代码，而且鼠标就停留在第一个href的双引号之间。那是多么愉快的事情。这就是EditPlus的自动完成功能，使用EditPlus的自动完成功能将会极大的提高你的工作效率。而且我们可以根据不同的文件类型，建立不同的“自动完成”，例如，如果是xhtml文件，打“b”+ 空格”，就是 <strong></strong>，而在css文件中，“b”+ 空格”，就是 “border:1px solid red;”。非常的人性化。</p>
<p>你可以通过这样的设置，来使用EditPlus的自动完成功能。【Tools】→【Preperences】→ 【Files】→ 【Settings &amp; syntax】 → 在【File types】中设置一下文件类型，然后再【Auto completion】中选择自动完成文件即可（如果你使用的是我那个 EditPlus压缩包文件，请注意调整这里的自动完成文件的路径）。自动完成文件我们可以自己进行编辑，这里我举个简单的例子，展开下面的代码，这个便是我css文件自动完成的文件内容，以第11行的“#T=bor”为例，它的意思就是如果输入bor然后按空格，就在光标所在位置插入“border:1px solid red;”</p>
<p>css自动完成例子
#TITLE=CSS
; EditPlus Auto-completion file v1.0 written by Justin Young(<a href="http://justinyoung.cnblogs.com" target="_blank" rel="external">http://justinyoung.cnblogs.com</a>).
; This file is provided as a default auto-completion file for CSS.</p>
<p>#T=*</p>
<ul>
<li>{}{margin:0; padding:0; list-style:none; }
^!
#T=bo
border:1px solid #^!;
#T=bor
border:1px solid red;
^!
#T=fl
float:left;
#T=fr
float:right;
#T=poa
position:absolute;
#T=por
position:relative;
#T=bg
background:url(‘…/Images/^!.gif’) no-repeat;
#T=bgc
background-color:^!;
#T=he
height:^!px;
#T=wi
width:^!px;
#T=ml
margin-left:^!px;
#T=mr
margin-right:^!px;
#T=mt
margin-top:^!px;
#T=mb
margin-bottom:^!px;
#T=pt
padding-top:^!px;
#T=pr
padding-right:^!px;
#T=pl
padding-left:^!px;
#T=pb
padding-bottom:^!px;
#T=bt
border-top:1px solid ^!;
#T=br
border-right:1px solid ^!;
#T=bl
border-left:1px solid ^!;
#T=bb
border-bottom:1px solid ^!;
#T=
;</li>
</ul>
<p>关于“自动完成”文件再说两句：</p>
<p>1：在我提供的那个 EditPlus压缩包文件中“自动完成”文件存放在解压目录下的“yzyFileAutoCompletion”文件夹下。</p>
<p>2：你可以通过直接编辑，解压目录下的“yzyFileAutoCompletion”文件夹下的EditPlus自动完成文件，来快速的建立自己的EditPlus自动完成文件。</p>
<p>EditPlus自动完成
图5：“自动完成”和“高亮语法”设置对话框</p>
<p>彩色的文件，高亮语法文件</p>
<p>很多的开发工具都有语法高亮显示功能，EditPlus虽小，但是也有这个功能哦。设置方法可以参考图片5所示。和“自动完成”功能一样，只要为不同的文件类型指定“高亮语法”文件即可。css、html等常用的文件类型，EditPlus已经自带了高亮语法文件。如果自带的高亮语法文件没有你需要的，你可以去EditPlus官方网站的文件下载频道去看看，来自全球各地的朋友，贡献了很多的不同文件类型的高亮语法文件。可以很方便地免费下载到。</p>
<p>这里就稍微列举一下比较常用的EditPlus的高亮语法文件，更多的请到EditPlus的官方网站下载，EditPlus的官方地址为： <a href="http://www.editplus.com/files.html" target="_blank" rel="external">http://www.editplus.com/files.html</a></p>
<p>EditPlus SQL 高亮语法文件
EditPlus C ++ 高亮语法文件
EditPlus C#高亮语法文件
EditPlus Java 高亮语法文件
EditPlus PHP 高亮语法文件
EditPlus CSS HTML高亮语法文件
EditPlus正则表达式</p>
<p>EditPlus中的查找（替换）功能，支持正则表达式。使用正则表达式可以极大的提高查找（替换）的强悍程度。因为正则表达式这东西不是一句话就能说完的，而且偏离此篇文章主题，所以这里只列举几个常用的例子。对此有兴趣的可以参考正则表达式资料，或者在EditPlus的help中“Regular Expression”关键字进行索引查找。</p>
<p>EditPlus正则表达式
图6：在查找（替换）对话框中使用正则表达式</p>
<p>使用正则表达式进行查找（替换）的方法如上图所示，选择查找（替换）对话框中“Regular Expression”前面checkbox。点击查找（替换）文本框后的“倒三角”可以选择常用的正则表达式。</p>
<p>正则表达式实例</p>
<p>需求说明
正则表达式写法
备注</p>
<p>替换指定内容（以abc为例）到行尾
abc.*
“.”表示匹配任意字符；“*”表示匹配0次或更多</p>
<p>给所有的数字加上引号
查找[0-9]替换为&quot;&quot;
表示正则表达式匹配的对象</p>
<p>删除空白行
查找nn 替换为n
把连续的2个换行符，替换成一个换行符</p>
<p>矩形选区</p>
<p>看到这个词，好像是说图像处理工具，其实非也，不管是VS还是EditPlus，其实都是支持矩形选区的。这对处理一些形如：去掉文章前端行号的情况有特效，矩形全区的选取方式就是按住Alt键，然后用鼠标划矩形选区(如图7所示)。需要注意到是在“自动换行”的情况下，是不能使用“矩形选区”的。你可以使用Ctrl+Shift +W来切换“自动换行”或者“不自动换行”视图。</p>
<p>在EditPlus中选取矩形选区
图7：在EditPlus中选取矩形选区（注意红色框内的“自动换行图标”）</p>
<p>提高工作效率，EditPlus 快捷键的使用</p>
<p>如果一个来你们公司面试程序员，连Ctrl + C 和Ctrl + V 都不用，而是使用“选中文本”→ 鼠标右键 → 【复制】，然后再鼠标右键→ 【粘贴】。你会不会录用他呢？（你还别笑，以前我们公司还真面试过一个这样的，所谓的“<a href="http://xn--asp-837h493f.net" target="_blank" rel="external">精通asp.net</a>”的程序员）。所以熟练的使用软件的快捷键，不仅仅能够极大的提高工作效率，也从一个侧面表现出一个人对此软件的使用能力。EditPlus同样也有很多的快捷键，下面是一些我经常使用的EditPlus特有的快捷键（Ctrl +C 、Ctrl+H这样的通用快捷键就不介绍了），略举一二，更多的请参看文章《EditPlus快捷键》</p>
<p>以浏览器模式预览文件
Ctrl + B</p>
<p>开始编辑“以浏览器模式预览的文件”
Ctrl + E</p>
<p>新建html文件
Ctrl+Shift+N</p>
<p>新建浏览器窗口（类似于在EditPlus中打开ie）
Ctrl+Shift+B</p>
<p>选中的字母切换为小写
Ctrl+L</p>
<p>选中的字母切换为大写
Ctrl+U</p>
<p>选中的词组首字母大写
Ctrl+Shift+U</p>
<p>复制选定文本并追加到剪贴板中
Ctrl+Shift+C</p>
<p>剪切选定文本并追加到剪贴板中
Ctrl+Shift+X</p>
<p>创建当前行的副本
Ctrl+J</p>
<p>复制上一行的一个字符到当前行
Ctrl±</p>
<p>剪切选定文本并追加到剪贴板中
Ctrl+Shift+X</p>
<p>合并选定行
Ctrl+Shift+J</p>
<p>反转选定文本的大小写
Ctrl+K</p>
<p>开始/结束选择区域
Alt+Shift+B</p>
<p>选择当前行
Ctrl+R</p>
<p>全屏模式开/关
Ctrl+K</p>
<p>显示或隐藏标尺
Alt+Shift+R</p>
<p>显示或隐藏制表符与空格
Alt+Shift+I</p>
<p>显示函数列表
Ctrl+F11</p>
<p>转到当前文档的指定行
Ctrl + G</p>
<p>设置或清除当前行的标记
F9</p>
<p>转到下一个标记位置
F4</p>
<p>转到上一个标记位置
Shift+F4</p>
<p>清除当前文档中的所有标记
Ctrl+Shift+F9</p>
<p>搜索一对匹配的括号
Ctrl+]</p>
<p>搜索一对匹配的括号并选择该文本
Ctrl+Shift+]</p>
<p>切换当前文档的自动换行功能
Ctrl+Shift+W</p>
<p>编辑当前 HTML 页面的源文件
Ctrl+E</p>
<p>我写博客的模板</p>
<p>好像这个不应该放在这篇文章中来写，但是因为我写博文一直在EditPlus中写，所以就顺便放在这篇文章中吧。</p>
<p>有一些朋友问我，你一篇那么花里胡哨的博文需要多长时间吧，关排版就要不少时间吧。其实，排版还真就没用多少时间，因为我已经编辑好一个通用的博文模板了，这个模板包含了我所有博文文章中可能出现的排版情况。每次写博文只要套用模板就可以了，无非就是换换字，换换图片链接地址而且。因为还蛮能提高写博文的效率和排版效果的，所以现在就共享出来供大家使用，希望大家也一样能够写出漂亮的文章。</p>
<p>EditPlus模板下载YES!B/S!文章模板下载
EditPlus模板下载</p>
<p>感谢未注册用户初学者1，提供EditPlus2.31版本的代码折叠功能的使用方法。</p>
<p>初学者1: CTRL+Shift+F 可以打开代码折叠开关。
菜单在：查看－代码折叠－使用代码折叠
我的版本是：2.31（488）</p>
<p>俺补充一下：html标签，如果要想折叠，必须注意便签内的代码要用tab缩进。
因为快捷键是使用小键盘的 &quot;+“和”-&quot;所以使用笔记本的会比较郁闷。可以通过设置快捷键达到你的使用习惯。
设置快捷键的方法：。【Tools】→【Preperences】→ 【Tools】→【KeyBorad】→选择类型为【view】然后在右面列表框中找到展开和收缩。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/05/java-simple-web-server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/05/java-simple-web-server/" itemprop="url">Here is a tutorial on how to whip up a simple web server in Java? with working runnable code; sourcecode and bytecode files.</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>This is the window that comes up when you run the program, just a little motivator so you can see what��s in the end of the tunnel.</p>
<p>Note to get the maximum out of this tutorial it is recommended that you have a basic grasp on how HTTP works. If the little man inside your head says what tha H is HTTP, you should go to the bottom and check some of the pointers. There you will find some nice text to explain the basic concept.</p>
<p>Let��s get started!
When making a program nowadays the first thing you should think about is the GUI (graphical user interface). If the program dosen��t look fancy, you can just press all the cancel buttons on the project. Ok that was meant as a joke, but there is some truth in it. People tend to judge a program a lot on its look, even though the real coding job is in making the stuff that goes on behind the scenes.</p>
<p>The good news is that we are making this in Java, and since Java is such a friendly programming language it��s real easy to get some interface going. Comments are in green.</p>
<p>//file: webserver_starter.java
//declare a class wich inherit JFrame
public classwebserver_starter
extendsJFrame {
//declare some panel, scrollpanel, textarea for gui
JPanel jPanel1 = newJPanel();
JScrollPane jScrollPane1 = newJScrollPane();
JTextArea jTextArea2 = newJTextArea();
staticInteger listen_port = null;
//basic class constructor
publicwebserver_starter() {
try{
jbInit();
}
catch(Exception e) {
e.printStackTrace();
}
}
//the JavaAPI entry point
//where it starts this class if run
public staticvoidmain(String[] args) {
//start server on port x, default 80
//use argument to main for what port to start on
try{
listen_port = newInteger(args[0]);
//catch parse error
}
catch(Exception e) {
listen_port = newInteger(80);
}
//create an instance of this class
webserver_starter webserver = newwebserver_starter();
}
//set up the user interface
privatevoidjbInit() throwsException {
//oh the pretty colors
jTextArea2.setBackground(newColor(16, 12, 66));
jTextArea2.setForeground(newColor(151, 138, 255));
jTextArea2.setBorder(BorderFactory.createLoweredBevelBorder());
jTextArea2.setToolTipText(&quot;&quot;);
jTextArea2.setEditable(false);
jTextArea2.setColumns(30);
jTextArea2.setRows(15);
//change this to impress your friends
this.setTitle(“Jon��s fancy prancy webserver”);
//ugly inline listener, it��s for handling closing of the window
this.addWindowListener(newjava.awt.event.WindowAdapter() {
publicvoidwindowClosing(WindowEvent e) {
this_windowClosed(e);
}
});
//add the various to the proper containers
jScrollPane1.getViewport().add(jTextArea2);
jPanel1.add(jScrollPane1);
this.getContentPane().add(jPanel1, BorderLayout.EAST);
//tveak the apearance
this.setVisible(true);
this.setSize(420, 350);
this.setResizable(false);
//make sure it is drawn
this.validate();
//create the actual serverstuff,
//all that is implemented in another class
newserver(listen_port.intValue(), this);
}
//exit program when “X” is pressed.
voidthis_windowClosed(WindowEvent e) {
System.exit(1);
}
//this is a method to get messages from the actual
//server to the window
publicvoidsend_message_to_window(String s) {
jTextArea2.append(s);
}
} //class end</p>
<p>In a nutshell this code sets up the window and makes everything look good. If you look at the picture of the program on top of this page. This code makes that!</p>
<p>Ok, enough time wasted on the look. Lets get down with the fun stuff, making the actual httpserver.</p>
<p>//file: server.java
//the real (http) serverclass
//it extends thread so the server is run in a different
//thread than the gui, that is to make it responsive.
//it��s really just a macho coding thing.
public classserver
extendsThread {
//the constructor method
//the parameters it takes is what port to bind to, the default tcp port
//for a httpserver is port 80. the other parameter is a reference to
//the gui, this is to pass messages to our nice interface
publicserver(intlisten_port, webserver_starter to_send_message_to) {
message_to = to_send_message_to;
port = listen_port;
//this makes a new thread, as mentioned before,it��s to keep gui in
//one thread, server in another. You may argue that this is totally
//unnecessary, but we are gonna have this on the web so it needs to
//be a bit macho! Another thing is that real pro webservers handles
//each request in a new thread. This server dosen��t, it handles each
//request one after another in the same thread. This can be a good
//assignment!! To redo this code so that each request to the server
//is handled in its own thread. The way it is now it blocks while
//one client access the server, ex if it transferres a big file the
//client have to wait real long before it gets any response.
this.start();
}
privatevoids(String s2) { //an alias to avoid typing so much!
message_to.send_message_to_window(s2);
}
privatewebserver_starter message_to; //the starter class, needed for gui
privateintport; //port we are going to listen to
//this is a overridden method from the Thread class we extended from
publicvoidrun() {
//we are now inside our own thread separated from the gui.
ServerSocket serversocket = null;
//To easily pick up lots of girls, change this to your name!!!
s(“The simple httpserver v. 0000000000nCoded by Jon Berg” +
&quot;&lt;jon.berg[on server]<a href="http://turtlemeat.com" target="_blank" rel="external">turtlemeat.com</a>&gt;nn&quot;);
//Pay attention, this is where things starts to cook!
try{
//print/send message to the guiwindow
s(“Trying to bind to localhost on port &quot; + Integer.toString(port) + “��”);
//make a ServerSocket and bind it to given port,
serversocket = newServerSocket(port);
}
catch(Exception e) { //catch any errors and print errors to gui
s(“nFatal Error:” + e.getMessage());
return;
}
s(“OK!n”);
//go in a infinite loop, wait for connections, process request, send response
while(true) {
s(“nReady, Waiting for requests��n”);
try{
//this call waits/blocks until someone connects to the port we
//are listening to
Socket connectionsocket = serversocket.accept();
//figure out what ipaddress the client commes from, just for show!
InetAddress client = connectionsocket.getInetAddress();
//and print it to gui
s(client.getHostName() + &quot; connected to server.n”);
//Read the http request from the client from the socket interface
//into a buffer.
BufferedReader input =
newBufferedReader(newInputStreamReader(connectionsocket.
getInputStream()));
//Prepare a outputstream from us to the client,
//this will be used sending back our response
//(header + requested file) to the client.
DataOutputStream output =
newDataOutputStream(connectionsocket.getOutputStream());
//as the name suggest this method handles the http request, see further down.
//abstraction rules
http_handler(input, output);
}
catch(Exception e) { //catch any errors, and print them
s(“nError:” + e.getMessage());
}
} //go back in loop, wait for next request
}
//our implementation of the hypertext transfer protocol
//its very basic and stripped down
privatevoidhttp_handler(BufferedReader input, DataOutputStream output) {
intmethod = 0; //1 get, 2 head, 0 not supported
String http = newString(); //a bunch of strings to hold
String path = newString(); //the various things, what http v, what path,
String file = newString(); //what file
String user_agent = newString(); //what user_agent
try{
//This is the two types of request we can handle
//GET /index.html HTTP/1.0
//HEAD /index.html HTTP/1.0
String tmp = input.readLine(); //read from the stream
String tmp2 = newString(tmp);
tmp.toUpperCase(); //convert it to uppercase
if(tmp.startsWith(“GET”)) { //compare it is it GET
method = 1;
} //if we set it to method 1
if(tmp.startsWith(“HEAD”)) { //same here is it HEAD
method = 2;
} //set method to 2
if(method == 0) { // not supported
try{
output.writeBytes(construct_http_header(501, 0));
output.close();
return;
}
catch(Exception e3) { //if some error happened catch it
s(“error:” + e3.getMessage());
} //and display error
}
//}
//tmp contains “GET /index.html HTTP/1.0 ����.”
//find first space
//find next space
//copy whats between minus slash, then you get “index.html”
//it��s a bit of dirty code, but bear with me��
intstart = 0;
intend = 0;
for(inta = 0; a &lt; tmp2.length(); a++) {
if(tmp2.charAt(a) == �� �� &amp;&amp; start != 0) {
end = a;
break;
}
if(tmp2.charAt(a) == �� �� &amp;&amp; start == 0) {
start = a;
}
}
path = tmp2.substring(start + 2, end); //fill in the path
}
catch(Exception e) {
s(“errorr” + e.getMessage());
} //catch any exception
//path do now have the filename to what to the file it wants to open
s(“nClient requested:” + newFile(path).getAbsolutePath() + “n”);
FileInputStream requestedfile = null;
try{
//NOTE that there are several security consideration when passing
//the untrusted string “path” to FileInputStream.
//You can access all files the current user has read access to!!!
//current user is the user running the javaprogram.
//you can do this by passing “…/” in the url or specify absoulute path
//or change drive (win)
//try to open the file,
requestedfile = newFileInputStream(path);
}
catch(Exception e) {
try{
//if you could not open the file send a 404
output.writeBytes(construct_http_header(404, 0));
//close the stream
output.close();
}
catch(Exception e2) {}
;
s(“error” + e.getMessage());
} //print error to gui
//happy day scenario
try{
inttype_is = 0;
//find out what the filename ends with,
//so you can construct a the right content type
if(path.endsWith(&quot;.zip&quot;
) {
type_is = 3;
}
if(path.endsWith(&quot;.jpg&quot;) || path.endsWith(&quot;.jpeg&quot;)) {
type_is = 1;
}
if(path.endsWith(&quot;.gif&quot;)) {
type_is = 2;
//write out the header, 200 -&gt;everything is ok we are all happy.
}
output.writeBytes(construct_http_header(200, 5));
//if it was a HEAD request, we don��t print any BODY
if(method == 1) { //1 is GET 2 is head and skips the body
while(true) {
//read the file from filestream, and print out through the
//client-outputstream on a byte per byte base.
intb = requestedfile.read();
if(b == -1) {
break; //end of file
}
output.write(b);
}
}
//clean up the files, close open handles
output.close();
requestedfile.close();
}
catch(Exception e) {}
}
//this method makes the HTTP header for the response
//the headers job is to tell the browser the result of the request
//among if it was successful or not.
privateString construct_http_header(intreturn_code, intfile_type) {
String s = &quot;HTTP/1.0 &quot;;
//you probably have seen these if you have been surfing the web a while
switch(return_code) {
case200:
s = s + “200 OK”;
break;
case400:
s = s + “400 Bad Request”;
break;
case403:
s = s + “403 Forbidden”;
break;
case404:
s = s + “404 Not Found”;
break;
case500:
s = s + “500 Internal Server Error”;
break;
case501:
s = s + “501 Not Implemented”;
break;
}
s = s + “rn”; //other header fields,
s = s + “Connection: closern”; //we can��t handle persistent connections
s = s + “Server: SimpleHTTPtutorial v0rn”; //server name
//Construct the right Content-Type for the header.
//This is so the browser knows what to do with the
//file, you may know the browser dosen��t look on the file
//extension, it is the servers job to let the browser know
//what kind of file is being transmitted. You may have experienced
//if the server is miss configured it may result in
//pictures displayed as text!
switch(file_type) {
//plenty of types for you to fill in
case0:
break;
case1:
s = s + “Content-Type: image/jpegrn”;
break;
case2:
s = s + “Content-Type: image/gifrn”;
case3:
s = s + “Content-Type: application/x-zip-compressedrn”;
default:
s = s + “Content-Type: text/htmlrn”;
break;
}
////so on and so on����
s = s + “rn”; //this marks the end of the httpheader
//and the start of the body
//ok return our newly created header!
returns;
}
} //class phhew caffeine yes please!</p>
<p>BEWARE! When you run the web server you are potentially opening for all your files to be red by the entire Internet! The httpserver is only ment to be used for testing. If you absoulutely want to run this httpserver for longer periods of time; consider creating a new user with only read access to the files you want to share and running it only with this user!</p>
<p>Download the tutorial files! this zipfile contains both sourcecode and compiled javabytecode files. So you can test the program without having the javacompiler. It also contains a sample index.html and a jpg file.</p>
<p>How to run the program? Get into commandline, cd to the dir where you extracted the files (webserver_starter.class and the other files). Then type: java webserver_starter</p>
<p>Then the window you see on top of this page should pop up. To test if this httpserver is really functioning, you open your browser, and in the location line you type: <a href="http://localhost/index.html" target="_blank" rel="external">http://localhost/index.html</a> ,this will bring up a sample html file that is in the zipfile.</p>
<p>If you want to test the httpserver from another machine on the Internet, then you need to know the ip-address or hostname the httpserver is running on, then you type that in the location line in the browser, like <a href="http://123.123.123.123/index.html" target="_blank" rel="external">http://123.123.123.123/index.html</a> .Note, it may not work if you are behind a firewall or a NAT router, but that��s not the programs�� fault!</p>
<p>Update: Oct 2011. This code is not actively updated, but I changed a few things mainly due to many people are referencing this. The switch (file_type) was missing breaks. requestedfile.read() and output.write() now reads and writes a byte array which speeds things up. And added favicon support since somebody asked about it.</p>
<p>How to compile: Open command line. cd to directory where you unpacked it. javac *.java
How to run: Open command line. cd to directory where you unpacked it. java -cp . webserver_starter</p>
<p>Pointers to related stuff on the hypertext transfer protocol (http) and web servers:</p>
<p>HowStuffWorks This is a very basic introduction for the novice on how web servers works. Has also other text about Internet and Routers, in easy to understandable language. Nice if you are starting out learning.</p>
<p>HTTP Made Really Easy Here is some nice text that goes through the main points in HTTP. A little more technical. It��s recommended that you know these things to understand the above tutorial.
Apache the best and most widely used web server on the Internet today, check it out. If you want to run your own web server this is the one to get, you can get binaries for both Windows and Unix. You can download the entire sourcecode if you want to check how it was made.</p>
<p>Mozilla / Netscape is a nice web browser. Get rid of the Explorer, there are some rumors that Internet Explorer secretly collects all the pages you are visiting and sends it to <a href="http://microsoft.com" target="_blank" rel="external">microsoft.com</a>.</p>
<p>RFC-1945 RFC describing Hypertext Transfer Protocol �� HTTP/1.0</p>
<p>RFC-2616 RFC describing Hypertext Transfer Protocol �� HTTP/1.1</p>
<p>RFC webpage The Request For Comment webpage, RFC are technical documents describing all sorts of protocols on the Internet.</p>
<p>Java2 Runtime / SDK Download site for the Java Runtime (needed for running Java programs) and Java Software Development Kit (needed for making Java programs).</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://2le.me/2013/01/05/linux-ubuntu-update-grub/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bianle">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/bianle">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bianle's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/01/05/linux-ubuntu-update-grub/" itemprop="url">安装Ubuntu后找不到windows sudo update-grub</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>我已经在Ubuntu 9.10里通过终端sudo update-grub两次了，结果还是一样不能启动XP和Windows 7。以下是在一位好心的网友的热心帮助下，经过本人亲身试验，而且行之有效的解决方法：</p>
<p>原因是采用了硬盘安装方式安装Ubuntu后，把那个引导工具grldr破坏了</p>
<p>修改Ubuntu 9.10里的/boot/grub/grub.cfg文件中Windows 7的启动选项，或者直接复制增加以下这个Windows 7选项吧。</p>
<p>menuentry “Windows 7” {
insmod ntfs
set root=(hd0,1)
drivemap -s (hd0) ${root}</p>
<p>chainloader +1
}</p>
<p>这个应该就可以进入grub4dos 的菜单，然后按 C 进入GRUB的DOS状态 ，在grub&gt;提示符下输入以下三条命令来修复引导工具grldr即可</p>
<p>grub&gt;root (hd0,0)
grub&gt;chainloader /bootmgr
grub&gt;boot</p>
<p>进入Windows 7后要重新激活Windows 7，然后就正式恢复了Ubuntu 9.10和Windows 7的双系统启动菜单了，至于XP是在Windows 7的启动菜单里的，一样正常了。哈哈！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/18/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><span class="page-number current">19</span><a class="page-number" href="/page/20/">20</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><a class="extend next" rel="next" href="/page/20/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars.githubusercontent.com/bianle"
               alt="bianle" />
          <p class="site-author-name" itemprop="name">bianle</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">266</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">58</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">167</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bianle" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bianlelpqi" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/i9erle" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://😇😈.ws" title="http://😇😈.ws" target="_blank">http://😇😈.ws</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://dzm.la" title="短怎么啦" target="_blank">短怎么啦</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.tunnel.ink" title="ngrok" target="_blank">ngrok</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://xingyetang.com" title="唐兴业的博客" target="_blank">唐兴业的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.panpan.lu" title="卢盼盼的博客" target="_blank">卢盼盼的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yangjian.me" title="Alimon's Blog" target="_blank">Alimon's Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://hexo.io" title="Hexo" target="_blank">Hexo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://timyang.net" title="Tim's Blog" target="_blank">Tim's Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://lifegoo.pluskid.org/wiki/index.html" title="星黎殿" target="_blank">星黎殿</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://phl.iteye.com" title="猫头哥（朴海林）" target="_blank">猫头哥（朴海林）</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zhaxiancheng" title="zxc" target="_blank">zxc</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2012 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bianle</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user">本站访客数</i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye">本站总访问量</i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "c9597f1b39254c22ba2f3fb2160ff765",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (search_path.endsWith("json")) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === '') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

</body>
</html>
